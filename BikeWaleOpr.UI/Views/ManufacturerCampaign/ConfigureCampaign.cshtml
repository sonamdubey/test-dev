@model BikewaleOpr.Models.ManufacturerCampaign.ManufacturerCampaignInformationModel

@{
    ViewBag.Title = "Configure Campaign";
    ViewBag.PageTitle = "Configure Campaign for " + Model.CampaignInformation.DealerDetails.DealerName;
}

@Html.Partial("~/Views/ManufacturerCampaign/_NavigationBreadcrumbs.cshtml", Model.NavigationWidget)

@if (Model != null && Model.CampaignInformation != null && Model.CampaignInformation.DealerDetails != null)
{
    <form action="/manufacturercampaign/save/campaign/" method="post">
        <div class="col padding-bottom10" id="ConfigureCampaign">
            <div class="row">
                <div class="col s5 offset-s3">
                    <span class="flow-text">@Model.CampaignInformation.DealerDetails.DealerName</span>
                </div>
            </div>

            <div class="row">
                <div class="input-field col s6 offset-s3">
                    <input id="txtCampaignDescription" type="text" class="validate" maxlength="100" name="Description" data-bind="textInput : $root.description" data-value="@Model.CampaignInformation.DealerDetails.Description" value="@Model.CampaignInformation.DealerDetails.Description">
                    <label for="txtCampaignDescription">Campaign Description *</label>
                </div>
            </div>

            <div class="row">
                <div class="input-field col s2 offset-s3">
                    <input id="txtMaskingNumber" type="text" class="validate" disabled data-bind="textInput : $root.maskingNumber()" data-value="@Model.CampaignInformation.DealerDetails.MaskingNumber">
                    <label for="txtMaskingNumber" id="labelMaskingNumber">Masking Number</label>
                </div>


                <div class="input-field col s2">
                    <select id="selMaskingNumber">
                        <option value="0" disabled selected>Select Masking Number</option>
                        @if (Model.MaskingNumbers != null && Model.MaskingNumbers.Count() > 0)
                        {
                            foreach (var numberEntity in Model.MaskingNumbers)
                            {
                                if (numberEntity.IsAssigned)
                                {
                                <option value="@numberEntity.Number" disabled>@numberEntity.Number</option>
                                }
                                else
                                {
                                <option value="@numberEntity.Number">@numberEntity.Number</option>
                                }
                            }
                        }
                    </select>
                </div>

                <div class="input-field col s2">
                    <a href="javascript:void(0)" data-bind="click : $root.releaseMaskingNumber">Release Masking Number</a>
                </div>
            </div>


            <div class="row">
                <div class="input-field col s2 offset-s3">
                    <input id="txtDailyLeadLimit" type="number" class="validate" name="DailyLeadLimit" value="@Model.CampaignInformation.DealerDetails.DailyLeadLimit">
                    <label for="txtDailyLeadLimit">Daily Leads Limit</label>
                </div>

                <div class="input-field col s2">
                    <input id="txtTotalLeadLimit" type="number" class="validate" name="TotalLeadLimit" value="@Model.CampaignInformation.DealerDetails.TotalLeadLimit">
                    <label for="txtTotalLeadLimit">Total Lead Limits</label>
                </div>
            </div>

            <div class="row">
                <div class="col s3 offset-s3">
                    <select multiple id="select-pages">
                        <option value="" disabled selected>Campaign Pages *</option>
                        @foreach (var page in Model.CampaignInformation.CampaignPages)
                        {
                            <option value="@page.PageId" @(page.IsSelected ? "selected" : "")>@page.PageName</option>
                        }
                    </select>
                </div>
            </div>

            <div class="row">
                <div class="col s2 offset-s3">
                    <div class="input-field">
                        <i class="material-icons prefix margin-top15">date_range</i>
                        <input type="date" id="startDateEle" class="datepicker margin-left5" data-bind="textInput : $root.startDate"  data-value="@(Model.CampaignInformation.DealerDetails.CampaignStartDate != DateTime.MinValue ? Model.CampaignInformation.DealerDetails.CampaignStartDate.ToString("yyyy-MM-dd") : "")" />
                        <label for="startDateEle">Campaign Start Date *</label>
                    </div>
                </div>

                <div class="col s1">
                    <div class="input-field">
                        <input type="time" id="startTimeEle" value="@Model.CampaignInformation.DealerDetails.CampaignStartDate.ToString("HH:mm")" />
                    </div>
                </div>

                <div class="col s2">
                    <div class="input-field">
                        <i class="material-icons prefix margin-top15">date_range</i>
                        <input type="date" id="endDateEle" class="datepicker margin-left5" value="@(Model.CampaignInformation.DealerDetails.CampaignEndDate != DateTime.MinValue ? Model.CampaignInformation.DealerDetails.CampaignEndDate.ToString("yyyy-MM-dd") : "")" />
                        <label for="endDateEle">Campaign End Date</label>
                    </div>
                </div>

                <div class="col s1">
                    <div class="input-field">
                        <input type="time" id="endTimeEle" value="@Model.CampaignInformation.DealerDetails.CampaignEndDate.ToString("HH:mm")" />
                    </div>
                </div>

            </div>
            <div class="row">
		 <div class="col s2 offset-s3">
			 <div style="margin-bottom:14px;"></div>
			 @{
				// CampaignDays if null should also run for all days hence set to 127 i.e running for all days of a week
				ushort campaignDays = (ushort)(Model.CampaignInformation.DealerDetails.CampaignDays == null ? 127 : Model.CampaignInformation.DealerDetails.CampaignDays);
				 
			 }
			 <select multiple id="select-days">
				 <option value="" disabled selected>Campaign Days</option>
				 <option value="64" @((campaignDays & 64) !=0? "selected" : "")>Sunday</option>
				 <option value="32" @((campaignDays & 32) != 0? "selected" : "")>Monday</option>
				 <option value="16" @((campaignDays & 16) != 0? "selected" : "")>Tuesday</option>
				 <option value="8" @((campaignDays & 8) != 0? "selected" : "")>Wednesday</option>
				 <option value="4" @((campaignDays & 4) != 0? "selected" : "")>Thursday</option>
				 <option value="2" @((campaignDays & 2) != 0? "selected" : "")>Friday</option>
				 <option value="1" @((campaignDays & 1) != 0? "selected" : "")>Saturday</option>
			 </select>
		 </div>
                <div class="col s1">
                    <div class="input-field">
                        @{ 
                            bool IsDailyTimeAvailable = Model.CampaignInformation.DealerDetails.DailyEndTime != DateTime.MinValue;
                        }
                        <input type="time" id="dailyStartTimeEle" value="@(IsDailyTimeAvailable ? Model.CampaignInformation.DealerDetails.DailyStartTime.ToString("HH:mm") : "")" />
                        <label for="dailyStartTimeEle" class="active">Daily Start Time</label>
                    </div>
                </div>
                <div class="col s1">
                    <div class="input-field">
                        <input type="time" id="dailyEndTimeEle" value="@(IsDailyTimeAvailable ? Model.CampaignInformation.DealerDetails.DailyEndTime.ToString("HH:mm") : "")" />
                        <label for="dailyEndTimeEle" class="active">Daily End Time</label>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col offset-s3">
                    <input type="checkbox" class="filled-in" id="chkShowCampaign" name="ShowOnExShowroomPrice" data-abc="@(Model.CampaignInformation.DealerDetails.ShowCampaignOnExshowroom)"  @(Model.CampaignInformation.DealerDetails.ShowCampaignOnExshowroom ? "checked value=true " : "") />
                    <label for="chkShowCampaign">Show Campaign On Exshoroom Price</label>
                </div>
            </div>
            <div class="row">
                <div class="col offset-s3">
                    <input type="checkbox" class="filled-in" id="chkSendLeadSMSCustomer" name="SendLeadSMSCustomer" data-abc="@(Model.CampaignInformation.DealerDetails.SendLeadSMSCustomer)" @(Model.CampaignInformation.DealerDetails.SendLeadSMSCustomer ? "checked value=true " : "") />
                    <label for="chkSendLeadSMSCustomer">Send SMS to the Customer on lead submission</label>
                </div>
            </div>

            <input type="hidden" name="CampaignId" id="inputCampaignId" value="@Model.CampaignId" />
            <input type="hidden" name="DealerId" id="inputDealerId" value="@Model.CampaignInformation.DealerDetails.Id" />
            <input type="hidden" id="CampaignPages" name="campaignPages" />
            <input type="hidden" id="campaignDays" name="campaignDays" />
            <input type="hidden" id="StartDate" name="startDate" />
            <input type="hidden" id="EndDate" name="endDate" />
            <input type="hidden" id="DailyStartTime" name="dailyStartTime" />
            <input type="hidden" id="DailyEndTime" name="dailyEndTime" />
            <input type="hidden" id="maskingNumber" name="MaskingNumber" data-bind="textInput : $root.maskingNumber()" />
            <input type="hidden" name="userId" id="userId" value="@BikeWaleOpr.Common.CurrentUser.Id" />
            <input type="hidden" id="olMaskingNumber" name="OldMaskingNumber" value="@Model.CampaignInformation.DealerDetails.MaskingNumber" />
            <input type="hidden" name="MobileNumber" value="@Model.CampaignInformation.DealerDetails.MobileNo" />

            <div class="row">
                <div class="col offset-s3">
                    <button id="btnConfigureCampaign" class="btn waves-effect waves-light" type="submit" name="action" data-bind="click : $root.configureCampaign">
                        Configure Campaign
                    </button>
                </div>
            </div>           
        </div>

    </form>

    <div id="alertModal" class="modal" style="height:170px;width:350px">
        <div class="modal-content">
            <p id="modal-p"></p>
        </div>
        <div class="modal-footer">
            <a href="#!" class="modal-action modal-close waves-effect waves-green btn-flat">Ok</a>
        </div>
    </div>

}
<script src="/src/ManufactureCampaign/ConfigureCampaign.js?12Mar2018"></script>
