óî
5D:\work\bikewaleweb\Bikewale.DAL.CoreDAL\CommonOpn.cs
	namespace 	
Bikewale
 
. 
CoreDAL 
{ 
public 

class 
	CommonOpn 
{ 
private 
HttpContext 
objTrace $
=% &
HttpContext' 2
.2 3
Current3 :
;: ;
private 
char 

_delimiter 
=  !
$char" %
;% &
publicWW 
staticWW 
stringWW 
FormatPriceWW (
(WW( )
stringWW) /
minPriceWW0 8
,WW8 9
stringWW: @
maxPriceWWA I
)WWI J
{XX 	
ifYY 
(YY 
(YY 
stringYY 
.YY 
IsNullOrEmptyYY %
(YY% &
minPriceYY& .
)YY. /
&&YY0 2
stringYY3 9
.YY9 :
IsNullOrEmptyYY: G
(YYG H
maxPriceYYH P
)YYP Q
)YYQ R
||YYS U
(YYV W
minPriceYYW _
==YY` b
$strYYc f
&&YYg i
maxPriceYYj r
==YYs u
$strYYv y
)YYy z
)YYz {
{ZZ 
return[[ 
$str[[ 
;[[ 
}\\ 
else]] 
if]] 
(]] 
minPrice]] 
==]]  
maxPrice]]! )
)]]) *
{^^ 
return__ 
FormatNumeric__ $
(__$ %
minPrice__% -
)__- .
;__. /
}`` 
elseaa 
returnbb 
FormatNumericbb $
(bb$ %
minPricebb% -
)bb- .
+bb/ 0
$strbb1 4
+bb5 6
FormatNumericbb7 D
(bbD E
maxPricebbE M
)bbM N
;bbN O
}cc 	
publicll 
staticll 
stringll 
FormatPricell (
(ll( )
stringll) /
pricell0 5
)ll5 6
{mm 	
ifnn 
(nn 
pricenn 
==nn 
$strnn 
||nn 
pricenn $
==nn% '
$strnn( +
)nn+ ,
returnoo 
$stroo 
;oo 
elsepp 
returnqq 
FormatNumericqq $
(qq$ %
priceqq% *
)qq* +
;qq+ ,
}rr 	
public
ÿÿ 
bool
ÿÿ 
IsSearchEngine
ÿÿ "
(
ÿÿ" #
)
ÿÿ# $
{
ŸŸ 	
bool
⁄⁄ 
ret
⁄⁄ 
=
⁄⁄ 
false
⁄⁄ 
;
⁄⁄ 
try
€€ 
{
‹‹ 
if
›› 
(
›› 
HttpContext
›› 
.
››  
Current
››  '
.
››' (
Request
››( /
.
››/ 0
Browser
››0 7
.
››7 8
Crawler
››8 ?
)
››? @
ret
ﬁﬁ 
=
ﬁﬁ 
true
ﬁﬁ 
;
ﬁﬁ 
}
ﬂﬂ 
catch
‡‡ 
(
‡‡ 
	Exception
‡‡ 
err
‡‡  
)
‡‡  !
{
·· 

ErrorClass
‚‚ 
objErr
‚‚ !
=
‚‚" #
new
‚‚$ '

ErrorClass
‚‚( 2
(
‚‚2 3
err
‚‚3 6
,
‚‚6 7
$str
‚‚8 H
)
‚‚H I
;
‚‚I J
objErr
„„ 
.
„„ 
SendMail
„„ 
(
„„  
)
„„  !
;
„„! "
}
‰‰ 
return
ÂÂ 
ret
ÂÂ 
;
ÂÂ 
}
ÊÊ 	
public
ÎÎ 
static
ÎÎ 
string
ÎÎ 
AppPath
ÎÎ $
{
ÏÏ 	
get
ÌÌ 
{
ÓÓ 
return
ÔÔ 
(
ÔÔ 
string
ÔÔ 
)
ÔÔ "
ConfigurationManager
ÔÔ 3
.
ÔÔ3 4
AppSettings
ÔÔ4 ?
[
ÔÔ? @
$str
ÔÔ@ I
]
ÔÔI J
;
ÔÔJ K
}
 
}
ÒÒ 	
public
ÛÛ 
static
ÛÛ 
string
ÛÛ  
ConvertToTitleCase
ÛÛ /
(
ÛÛ/ 0
string
ÛÛ0 6
input
ÛÛ7 <
)
ÛÛ< =
{
ÙÙ 	
TextInfo
ıı 
ti
ıı 
=
ıı 
new
ıı 
CultureInfo
ıı )
(
ıı) *
$str
ıı* 1
,
ıı1 2
false
ıı3 8
)
ıı8 9
.
ıı9 :
TextInfo
ıı: B
;
ııB C
return
˜˜ 
ti
˜˜ 
.
˜˜ 
ToTitleCase
˜˜ !
(
˜˜! "
input
˜˜" '
.
˜˜' (
ToLower
˜˜( /
(
˜˜/ 0
)
˜˜0 1
)
˜˜1 2
;
˜˜2 3
}
¯¯ 	
public
¸¸ 
bool
¸¸ '
GetNeedContactInformation
¸¸ -
(
¸¸- .
)
¸¸. /
{
˝˝ 	
bool
˛˛ 
value
˛˛ 
=
˛˛ 
true
˛˛ 
;
˛˛ 
if
ÄÄ 
(
ÄÄ 
HttpContext
ÄÄ 
.
ÄÄ 
Current
ÄÄ #
.
ÄÄ# $
Request
ÄÄ$ +
.
ÄÄ+ ,
Cookies
ÄÄ, 3
[
ÄÄ3 4
$str
ÄÄ4 L
]
ÄÄL M
!=
ÄÄN P
null
ÄÄQ U
&&
ÄÄV X
HttpContext
ÅÅ 
.
ÅÅ 
Current
ÅÅ #
.
ÅÅ# $
Request
ÅÅ$ +
.
ÅÅ+ ,
Cookies
ÅÅ, 3
[
ÅÅ3 4
$str
ÅÅ4 L
]
ÅÅL M
.
ÅÅM N
Value
ÅÅN S
.
ÅÅS T
ToString
ÅÅT \
(
ÅÅ\ ]
)
ÅÅ] ^
!=
ÅÅ_ a
$str
ÅÅb d
)
ÅÅd e
{
ÇÇ 
value
ÉÉ 
=
ÉÉ 
Convert
ÉÉ 
.
ÉÉ  
	ToBoolean
ÉÉ  )
(
ÉÉ) *
HttpContext
ÉÉ* 5
.
ÉÉ5 6
Current
ÉÉ6 =
.
ÉÉ= >
Request
ÉÉ> E
.
ÉÉE F
Cookies
ÉÉF M
[
ÉÉM N
$str
ÉÉN f
]
ÉÉf g
.
ÉÉg h
Value
ÉÉh m
)
ÉÉm n
;
ÉÉn o
}
ÑÑ 
else
ÖÖ 
{
ÜÜ 
value
áá 
=
áá 
true
áá 
;
áá 
}
àà 
return
ää 
value
ää 
;
ää 
}
ãã 	
public
êê 
void
êê  
SendNewsletterMail
êê &
(
êê& '
string
êê' -
email
êê. 3
,
êê3 4
string
êê5 ;
subject
êê< C
,
êêC D
string
êêE K
body
êêL P
,
êêP Q
bool
êêR V
htmlType
êêW _
)
êê_ `
{
ëë 	
try
íí 
{
ìì 

SmtpClient
ïï 
client
ïï !
=
ïï" #
new
ïï$ '

SmtpClient
ïï( 2
(
ïï2 3"
ConfigurationManager
ïï3 G
.
ïïG H
AppSettings
ïïH S
[
ïïS T
$str
ïïT `
]
ïï` a
)
ïïa b
;
ïïb c
string
òò 
	localMail
òò  
=
òò! ""
ConfigurationManager
òò# 7
.
òò7 8
AppSettings
òò8 C
[
òòC D
$str
òòD O
]
òòO P
.
òòP Q
ToString
òòQ Y
(
òòY Z
)
òòZ [
;
òò[ \
MailAddress
öö 
from
öö  
=
öö! "
new
öö# &
MailAddress
öö' 2
(
öö2 3
	localMail
öö3 <
,
öö< =
$str
öö> L
)
ööL M
;
ööM N
MailAddress
ùù 
to
ùù 
=
ùù  
new
ùù! $
MailAddress
ùù% 0
(
ùù0 1
email
ùù1 6
)
ùù6 7
;
ùù7 8
MailMessage
†† 
msg
†† 
=
††  !
new
††" %
MailMessage
††& 1
(
††1 2
from
††2 6
,
††6 7
to
††8 :
)
††: ;
;
††; <
msg
££ 
.
££ 
Headers
££ 
.
££ 
Add
££ 
(
££  
$str
££  $
,
££$ %
$str
££& <
)
££< =
;
££= >
msg
¶¶ 
.
¶¶ 

IsBodyHtml
¶¶ 
=
¶¶  
true
¶¶! %
;
¶¶% &
msg
ßß 
.
ßß 
Priority
ßß 
=
ßß 
MailPriority
ßß +
.
ßß+ ,
High
ßß, 0
;
ßß0 1
msg
™™ 
.
™™ 
Subject
™™ 
=
™™ 
subject
™™ %
;
™™% &
msg
≠≠ 
.
≠≠ 
Body
≠≠ 
=
≠≠ 
body
≠≠ 
;
≠≠  
client
∞∞ 
.
∞∞ 
Send
∞∞ 
(
∞∞ 
msg
∞∞ 
)
∞∞  
;
∞∞  !
objTrace
≤≤ 
.
≤≤ 
Trace
≤≤ 
.
≤≤ 
Warn
≤≤ #
(
≤≤# $
msg
≤≤$ '
.
≤≤' (
From
≤≤( ,
+
≤≤- .
$str
≤≤/ 2
+
≤≤3 4
msg
≤≤5 8
.
≤≤8 9
To
≤≤9 ;
+
≤≤< =
$str
≤≤> A
+
≤≤B C
msg
≤≤D G
.
≤≤G H
Subject
≤≤H O
+
≤≤P Q
$str
≤≤R U
+
≤≤V W
msg
≤≤X [
.
≤≤[ \
Body
≤≤\ `
)
≤≤` a
;
≤≤a b
}
≥≥ 
catch
¥¥ 
(
¥¥ 
	Exception
¥¥ 
err
¥¥  
)
¥¥  !
{
µµ 
objTrace
∂∂ 
.
∂∂ 
Trace
∂∂ 
.
∂∂ 
Warn
∂∂ #
(
∂∂# $
$str
∂∂$ :
+
∂∂; <
err
∂∂= @
.
∂∂@ A
Message
∂∂A H
)
∂∂H I
;
∂∂I J
}
∑∑ 
}
∏∏ 	
public
ºº 
static
ºº 
string
ºº 
AdPath
ºº #
{
ΩΩ 	
get
ææ 
{
øø 
string
¿¿ 
adPath
¿¿ 
=
¿¿ 
$str
¿¿  "
;
¿¿" #
if
¬¬ 
(
¬¬ 
HttpContext
¬¬ 
.
¬¬  
Current
¬¬  '
.
¬¬' (
Request
¬¬( /
.
¬¬/ 0
ServerVariables
¬¬0 ?
[
¬¬? @
$str
¬¬@ K
]
¬¬K L
.
¬¬L M
IndexOf
¬¬M T
(
¬¬T U
$str
¬¬U c
)
¬¬c d
>=
¬¬e g
$num
¬¬h i
)
¬¬i j
adPath
√√ 
=
√√ 
$str
√√ 8
;
√√8 9
else
ƒƒ 
adPath
≈≈ 
=
≈≈ 
$str
≈≈  
;
≈≈  !
return
«« 
adPath
«« 
;
«« 
}
»» 
}
…… 	
public
—— 
static
—— 
string
—— 
ResolvePath
—— (
(
——( )
string
——) /
RelativePath
——0 <
)
——< =
{
““ 	
return
”” 
(
”” 
string
”” 
)
”” "
ConfigurationManager
”” /
.
””/ 0
AppSettings
””0 ;
[
””; <
$str
””< E
]
””E F
+
””G H
RelativePath
””I U
;
””U V
}
’’ 	
public
‹‹ 
static
‹‹ 
string
‹‹ !
ResolvePhysicalPath
‹‹ 0
(
‹‹0 1
string
‹‹1 7
RelativePath
‹‹8 D
)
‹‹D E
{
›› 	
string
ﬁﬁ 
fullPath
ﬁﬁ 
=
ﬁﬁ 
(
ﬁﬁ 
string
ﬁﬁ %
)
ﬁﬁ% &"
ConfigurationManager
ﬁﬁ& :
.
ﬁﬁ: ;
AppSettings
ﬁﬁ; F
[
ﬁﬁF G
$str
ﬁﬁG P
]
ﬁﬁP Q
+
ﬁﬁR S
RelativePath
ﬁﬁT `
;
ﬁﬁ` a
Page
·· 
myPage
·· 
=
·· 
new
·· 
Page
·· "
(
··" #
)
··# $
;
··$ %
string
‚‚ !
makePleskCompatible
‚‚ &
=
‚‚' (
myPage
‚‚) /
.
‚‚/ 0
Server
‚‚0 6
.
‚‚6 7
MapPath
‚‚7 >
(
‚‚> ?
fullPath
‚‚? G
)
‚‚G H
.
‚‚H I
Replace
‚‚I P
(
‚‚P Q
$str
‚‚Q f
,
‚‚f g
$str‚‚h É
)‚‚É Ñ
;‚‚Ñ Ö
return
„„ !
makePleskCompatible
„„ &
;
„„& '
}
ÂÂ 	
public
ÍÍ 
static
ÍÍ 
void
ÍÍ 
	SaveImage
ÍÍ $
(
ÍÍ$ %
HtmlInputFile
ÍÍ% 2
fil
ÍÍ3 6
,
ÍÍ6 7
string
ÍÍ8 >
RelativePath
ÍÍ? K
)
ÍÍK L
{
ÎÎ 	
string
ÏÏ 
fullPath
ÏÏ 
=
ÏÏ 
(
ÏÏ 
string
ÏÏ %
)
ÏÏ% &"
ConfigurationManager
ÏÏ& :
.
ÏÏ: ;
AppSettings
ÏÏ; F
[
ÏÏF G
$str
ÏÏG P
]
ÏÏP Q
+
ÏÏR S
RelativePath
ÏÏT `
;
ÏÏ` a
fullPath
ÌÌ 
=
ÌÌ 
fullPath
ÌÌ 
.
ÌÌ  
Replace
ÌÌ  '
(
ÌÌ' (
$str
ÌÌ( 1
,
ÌÌ1 2
$str
ÌÌ3 5
)
ÌÌ5 6
;
ÌÌ6 7
HttpContext
ÓÓ 
.
ÓÓ 
Current
ÓÓ 
.
ÓÓ  
Trace
ÓÓ  %
.
ÓÓ% &
Warn
ÓÓ& *
(
ÓÓ* +
$str
ÓÓ+ ;
+
ÓÓ< =
fullPath
ÓÓ> F
)
ÓÓF G
;
ÓÓG H
Page
ÒÒ 
myPage
ÒÒ 
=
ÒÒ 
new
ÒÒ 
Page
ÒÒ "
(
ÒÒ" #
)
ÒÒ# $
;
ÒÒ$ %
string
ÚÚ !
makePleskCompatible
ÚÚ &
=
ÚÚ' (
myPage
ÚÚ) /
.
ÚÚ/ 0
Server
ÚÚ0 6
.
ÚÚ6 7
MapPath
ÚÚ7 >
(
ÚÚ> ?
fullPath
ÚÚ? G
)
ÚÚG H
.
ÚÚH I
Replace
ÚÚI P
(
ÚÚP Q
$str
ÚÚQ f
,
ÚÚf g
$strÚÚh ó
)ÚÚó ò
;ÚÚò ô
fil
ÙÙ 
.
ÙÙ 

PostedFile
ÙÙ 
.
ÙÙ 
SaveAs
ÙÙ !
(
ÙÙ! "!
makePleskCompatible
ÙÙ" 5
)
ÙÙ5 6
;
ÙÙ6 7
}
ıı 	
public
˝˝ 
static
˝˝ 
string
˝˝ &
ImagePathForSavingImages
˝˝ 5
(
˝˝5 6
string
˝˝6 <
RelativePath
˝˝= I
)
˝˝I J
{
˛˛ 	
string
ˇˇ 
fullPath
ˇˇ 
=
ˇˇ 
(
ˇˇ 
string
ˇˇ %
)
ˇˇ% &"
ConfigurationManager
ˇˇ& :
.
ˇˇ: ;
AppSettings
ˇˇ; F
[
ˇˇF G
$str
ˇˇG P
]
ˇˇP Q
+
ˇˇR S
RelativePath
ˇˇT `
;
ˇˇ` a
if
ÅÅ 
(
ÅÅ 
HttpContext
ÅÅ 
.
ÅÅ 
Current
ÅÅ #
.
ÅÅ# $
Request
ÅÅ$ +
.
ÅÅ+ ,
ServerVariables
ÅÅ, ;
[
ÅÅ; <
$str
ÅÅ< G
]
ÅÅG H
.
ÅÅH I
IndexOf
ÅÅI P
(
ÅÅP Q
$str
ÅÅQ ^
)
ÅÅ^ _
>=
ÅÅ` b
$num
ÅÅc d
)
ÅÅd e
fullPath
ÇÇ 
=
ÇÇ 
fullPath
ÇÇ #
.
ÇÇ# $
Replace
ÇÇ$ +
(
ÇÇ+ ,
$str
ÇÇ, 5
,
ÇÇ5 6
$str
ÇÇ7 9
)
ÇÇ9 :
;
ÇÇ: ;
HttpContext
ÑÑ 
.
ÑÑ 
Current
ÑÑ 
.
ÑÑ  
Trace
ÑÑ  %
.
ÑÑ% &
Warn
ÑÑ& *
(
ÑÑ* +
$str
ÑÑ+ ;
+
ÑÑ< =
fullPath
ÑÑ> F
)
ÑÑF G
;
ÑÑG H
Page
áá 
myPage
áá 
=
áá 
new
áá 
Page
áá "
(
áá" #
)
áá# $
;
áá$ %
string
àà !
makePleskCompatible
àà &
=
àà' (
myPage
àà) /
.
àà/ 0
Server
àà0 6
.
àà6 7
MapPath
àà7 >
(
àà> ?
fullPath
àà? G
)
ààG H
.
ààH I
Replace
ààI P
(
ààP Q
$str
ààQ f
,
ààf g
$strààh ó
)ààó ò
;ààò ô
HttpContext
ââ 
.
ââ 
Current
ââ 
.
ââ  
Trace
ââ  %
.
ââ% &
Warn
ââ& *
(
ââ* +
$str
ââ+ C
+
ââD E!
makePleskCompatible
ââF Y
)
ââY Z
;
ââZ [
return
ãã !
makePleskCompatible
ãã &
;
ãã& '
}
åå 	
public
èè 
static
èè 
string
èè 
	ImagePath
èè &
{
êê 	
get
ëë 
{
íí 
string
ìì 
imgPath
ìì 
=
ìì  
$str
ìì! #
;
ìì# $
if
ïï 
(
ïï 
HttpContext
ïï 
.
ïï  
Current
ïï  '
.
ïï' (
Request
ïï( /
.
ïï/ 0
ServerVariables
ïï0 ?
[
ïï? @
$str
ïï@ K
]
ïïK L
.
ïïL M
IndexOf
ïïM T
(
ïïT U
$str
ïïU b
)
ïïb c
>=
ïïd f
$num
ïïg h
)
ïïh i
{
ññ 
imgPath
óó 
=
óó 
$str
óó 8
;
óó8 9
}
ôô 
else
öö 
{
õõ 
imgPath
úú 
=
úú 
AppPath
úú %
+
úú& '
$str
úú( 1
;
úú1 2
}
ùù 
return
üü 
imgPath
üü 
;
üü 
}
†† 
}
°° 	
public
££ 
static
££ 
string
££ 
ResolveImagePath
££ -
(
££- .
string
££. 4
imgPath
££5 <
)
££< =
{
§§ 	
Page
¶¶ 
myPage
¶¶ 
=
¶¶ 
new
¶¶ 
Page
¶¶ "
(
¶¶" #
)
¶¶# $
;
¶¶$ %
string
ßß 
absPath
ßß 
=
ßß 
$str
ßß 
;
ßß  
if
©© 
(
©© 
HttpContext
©© 
.
©© 
Current
©© #
.
©©# $
Request
©©$ +
.
©©+ ,
ServerVariables
©©, ;
[
©©; <
$str
©©< G
]
©©G H
.
©©H I
IndexOf
©©I P
(
©©P Q
$str
©©Q ^
)
©©^ _
>=
©©` b
$num
©©c d
)
©©d e
{
™™ 
absPath
´´ 
=
´´ 
myPage
´´  
.
´´  !
Server
´´! '
.
´´' (
MapPath
´´( /
(
´´/ 0
imgPath
´´0 7
.
´´7 8
Replace
´´8 ?
(
´´? @
$str
´´@ Z
,
´´Z [
$str
´´\ _
)
´´_ `
)
´´` a
.
´´a b
ToLower
´´b i
(
´´i j
)
´´j k
.
´´k l
Replace
´´l s
(
´´s t
$str´´t Å
,´´Å Ç
$str´´É ì
)´´ì î
;´´î ï
}
¨¨ 
else
≠≠ 
{
ÆÆ 
absPath
ØØ 
=
ØØ 
myPage
ØØ  
.
ØØ  !
Server
ØØ! '
.
ØØ' (
MapPath
ØØ( /
(
ØØ/ 0
imgPath
ØØ0 7
)
ØØ7 8
;
ØØ8 9
}
∞∞ 
HttpContext
≥≥ 
.
≥≥ 
Current
≥≥ 
.
≥≥  
Trace
≥≥  %
.
≥≥% &
Warn
≥≥& *
(
≥≥* +
$str
≥≥+ C
+
≥≥D E
absPath
≥≥F M
)
≥≥M N
;
≥≥N O
return
¥¥ 
absPath
¥¥ 
;
¥¥ 
}
∂∂ 	
public
øø 
static
øø 
bool
øø 
CheckId
øø "
(
øø" #
string
øø# )
input
øø* /
)
øø/ 0
{
¿¿ 	
bool
¡¡ 
retVal
¡¡ 
=
¡¡ 
false
¡¡ 
;
¡¡  
try
¬¬ 
{
√√ 
if
≈≈ 
(
≈≈ 
Regex
≈≈ 
.
≈≈ 
IsMatch
≈≈ !
(
≈≈! "
input
≈≈" '
,
≈≈' (
$str
≈≈) 4
)
≈≈4 5
==
≈≈6 8
true
≈≈9 =
)
≈≈= >
{
∆∆ 
if
»» 
(
»» 
input
»» 
.
»» 
Length
»» $
<=
»»% '
$num
»»( )
)
»») *
{
…… 
retVal
   
=
    
true
  ! %
;
  % &
}
ÀÀ 
else
ÃÃ 
{
ÕÕ 
retVal
ŒŒ 
=
ŒŒ  
false
ŒŒ! &
;
ŒŒ& '
}
œœ 
}
–– 
else
—— 
{
““ 
retVal
”” 
=
”” 
false
”” "
;
””" #
}
‘‘ 
}
’’ 
catch
÷÷ 
(
÷÷ 
	Exception
÷÷ 
err
÷÷  
)
÷÷  !
{
◊◊ 
HttpContext
ÿÿ 
.
ÿÿ 
Current
ÿÿ #
.
ÿÿ# $
Trace
ÿÿ$ )
.
ÿÿ) *
Warn
ÿÿ* .
(
ÿÿ. /
err
ÿÿ/ 2
.
ÿÿ2 3
Message
ÿÿ3 :
)
ÿÿ: ;
;
ÿÿ; <
retVal
ŸŸ 
=
ŸŸ 
false
ŸŸ 
;
ŸŸ 
}
⁄⁄ 
return
‹‹ 
retVal
‹‹ 
;
‹‹ 
}
›› 	
public
‡‡ 
static
‡‡ 
bool
‡‡ 
	IsNumeric
‡‡ $
(
‡‡$ %
string
‡‡% +
input
‡‡, 1
)
‡‡1 2
{
·· 	
bool
‚‚ 
retVal
‚‚ 
=
‚‚ 
false
‚‚ 
;
‚‚  
try
„„ 
{
‰‰ 
if
ÊÊ 
(
ÊÊ 
Regex
ÊÊ 
.
ÊÊ 
IsMatch
ÊÊ !
(
ÊÊ! "
input
ÊÊ" '
,
ÊÊ' (
$str
ÊÊ) 4
)
ÊÊ4 5
==
ÊÊ6 8
true
ÊÊ9 =
)
ÊÊ= >
{
ÁÁ 
if
ÈÈ 
(
ÈÈ 
input
ÈÈ 
.
ÈÈ 
Length
ÈÈ $
<=
ÈÈ% '
$num
ÈÈ( )
)
ÈÈ) *
{
ÍÍ 
retVal
ÎÎ 
=
ÎÎ  
true
ÎÎ! %
;
ÎÎ% &
}
ÏÏ 
else
ÌÌ 
{
ÓÓ 
retVal
ÔÔ 
=
ÔÔ  
false
ÔÔ! &
;
ÔÔ& '
}
 
}
ÒÒ 
else
ÚÚ 
{
ÛÛ 
retVal
ÙÙ 
=
ÙÙ 
false
ÙÙ "
;
ÙÙ" #
}
ıı 
}
ˆˆ 
catch
˜˜ 
(
˜˜ 
	Exception
˜˜ 
err
˜˜  
)
˜˜  !
{
¯¯ 
HttpContext
˘˘ 
.
˘˘ 
Current
˘˘ #
.
˘˘# $
Trace
˘˘$ )
.
˘˘) *
Warn
˘˘* .
(
˘˘. /
err
˘˘/ 2
.
˘˘2 3
Message
˘˘3 :
)
˘˘: ;
;
˘˘; <
retVal
˙˙ 
=
˙˙ 
false
˙˙ 
;
˙˙ 
}
˚˚ 
return
˝˝ 
retVal
˝˝ 
;
˝˝ 
}
˛˛ 	
public
ÜÜ 
static
ÜÜ 
bool
ÜÜ 
CheckLongId
ÜÜ &
(
ÜÜ& '
string
ÜÜ' -
input
ÜÜ. 3
)
ÜÜ3 4
{
áá 	
bool
àà 
retVal
àà 
=
àà 
false
àà 
;
àà  
try
ââ 
{
ää 
if
åå 
(
åå 
Regex
åå 
.
åå 
IsMatch
åå !
(
åå! "
input
åå" '
,
åå' (
$str
åå) 4
)
åå4 5
==
åå6 8
true
åå9 =
)
åå= >
{
çç 
if
èè 
(
èè 
input
èè 
.
èè 
Length
èè $
<=
èè% '
$num
èè( *
)
èè* +
{
êê 
retVal
ëë 
=
ëë  
true
ëë! %
;
ëë% &
}
íí 
else
ìì 
{
îî 
retVal
ïï 
=
ïï  
false
ïï! &
;
ïï& '
}
ññ 
}
óó 
else
òò 
{
ôô 
retVal
öö 
=
öö 
false
öö "
;
öö" #
}
õõ 
}
úú 
catch
ùù 
(
ùù 
	Exception
ùù 
err
ùù  
)
ùù  !
{
ûû 
HttpContext
üü 
.
üü 
Current
üü #
.
üü# $
Trace
üü$ )
.
üü) *
Warn
üü* .
(
üü. /
err
üü/ 2
.
üü2 3
Message
üü3 :
)
üü: ;
;
üü; <
retVal
†† 
=
†† 
false
†† 
;
†† 
}
°° 
return
££ 
retVal
££ 
;
££ 
}
§§ 	
public
ÆÆ 
void
ÆÆ 
SendMail
ÆÆ 
(
ÆÆ 
string
ÆÆ #
email
ÆÆ$ )
,
ÆÆ) *
string
ÆÆ+ 1
subject
ÆÆ2 9
,
ÆÆ9 :
string
ÆÆ; A
body
ÆÆB F
)
ÆÆF G
{
ØØ 	
try
∞∞ 
{
±± 

SmtpClient
≥≥ 
client
≥≥ !
=
≥≥" #
new
≥≥$ '

SmtpClient
≥≥( 2
(
≥≥2 3"
ConfigurationManager
≥≥3 G
.
≥≥G H
AppSettings
≥≥H S
[
≥≥S T
$str
≥≥T `
]
≥≥` a
)
≥≥a b
;
≥≥b c
string
∂∂ 
	localMail
∂∂  
=
∂∂! ""
ConfigurationManager
∂∂# 7
.
∂∂7 8
AppSettings
∂∂8 C
[
∂∂C D
$str
∂∂D O
]
∂∂O P
.
∂∂P Q
ToString
∂∂Q Y
(
∂∂Y Z
)
∂∂Z [
;
∂∂[ \
MailAddress
∏∏ 
from
∏∏  
=
∏∏! "
new
∏∏# &
MailAddress
∏∏' 2
(
∏∏2 3
	localMail
∏∏3 <
,
∏∏< =
$str
∏∏> L
)
∏∏L M
;
∏∏M N
MailAddress
ªª 
to
ªª 
=
ªª  
new
ªª! $
MailAddress
ªª% 0
(
ªª0 1
email
ªª1 6
)
ªª6 7
;
ªª7 8
MailMessage
ææ 
msg
ææ 
=
ææ  !
new
ææ" %
MailMessage
ææ& 1
(
ææ1 2
from
ææ2 6
,
ææ6 7
to
ææ8 :
)
ææ: ;
;
ææ; <
msg
¡¡ 
.
¡¡ 
Headers
¡¡ 
.
¡¡ 
Add
¡¡ 
(
¡¡  
$str
¡¡  *
,
¡¡* +
$str
¡¡, B
)
¡¡B C
;
¡¡C D
msg
ƒƒ 
.
ƒƒ 

IsBodyHtml
ƒƒ 
=
ƒƒ  
true
ƒƒ! %
;
ƒƒ% &
msg
≈≈ 
.
≈≈ 
Priority
≈≈ 
=
≈≈ 
MailPriority
≈≈ +
.
≈≈+ ,
High
≈≈, 0
;
≈≈0 1
msg
»» 
.
»» 
Subject
»» 
=
»» 
subject
»» %
;
»»% &
msg
ÀÀ 
.
ÀÀ 
Body
ÀÀ 
=
ÀÀ 
body
ÀÀ 
;
ÀÀ  
client
““ 
.
““ 
Send
““ 
(
““ 
msg
““ 
)
““  
;
““  !
objTrace
‘‘ 
.
‘‘ 
Trace
‘‘ 
.
‘‘ 
Warn
‘‘ #
(
‘‘# $
msg
‘‘$ '
.
‘‘' (
From
‘‘( ,
+
‘‘- .
$str
‘‘/ 2
+
‘‘3 4
msg
‘‘5 8
.
‘‘8 9
To
‘‘9 ;
+
‘‘< =
$str
‘‘> A
+
‘‘B C
msg
‘‘D G
.
‘‘G H
Subject
‘‘H O
+
‘‘P Q
$str
‘‘R U
+
‘‘V W
msg
‘‘X [
.
‘‘[ \
Body
‘‘\ `
)
‘‘` a
;
‘‘a b
}
’’ 
catch
÷÷ 
(
÷÷ 
	Exception
÷÷ 
err
÷÷  
)
÷÷  !
{
◊◊ 
objTrace
ÿÿ 
.
ÿÿ 
Trace
ÿÿ 
.
ÿÿ 
Warn
ÿÿ #
(
ÿÿ# $
$str
ÿÿ$ :
+
ÿÿ; <
err
ÿÿ= @
.
ÿÿ@ A
Message
ÿÿA H
)
ÿÿH I
;
ÿÿI J

ErrorClass
ŸŸ 
objErr
ŸŸ !
=
ŸŸ" #
new
ŸŸ$ '

ErrorClass
ŸŸ( 2
(
ŸŸ2 3
err
ŸŸ3 6
,
ŸŸ6 7
$str
ŸŸ8 O
)
ŸŸO P
;
ŸŸP Q
objErr
⁄⁄ 
.
⁄⁄ 
SendMail
⁄⁄ 
(
⁄⁄  
)
⁄⁄  !
;
⁄⁄! "
}
€€ 
}
›› 	
public
ÂÂ 
void
ÂÂ 
SendMail
ÂÂ 
(
ÂÂ 
string
ÂÂ #
email
ÂÂ$ )
,
ÂÂ) *
string
ÂÂ+ 1
subject
ÂÂ2 9
,
ÂÂ9 :
string
ÂÂ; A
body
ÂÂB F
,
ÂÂF G
bool
ÂÂH L
htmlType
ÂÂM U
)
ÂÂU V
{
ÊÊ 	
try
ÁÁ 
{
ËË 

SmtpClient
ÍÍ 
client
ÍÍ !
=
ÍÍ" #
new
ÍÍ$ '

SmtpClient
ÍÍ( 2
(
ÍÍ2 3"
ConfigurationManager
ÍÍ3 G
.
ÍÍG H
AppSettings
ÍÍH S
[
ÍÍS T
$str
ÍÍT `
]
ÍÍ` a
)
ÍÍa b
;
ÍÍb c
string
ÌÌ 
	localMail
ÌÌ  
=
ÌÌ! ""
ConfigurationManager
ÌÌ# 7
.
ÌÌ7 8
AppSettings
ÌÌ8 C
[
ÌÌC D
$str
ÌÌD O
]
ÌÌO P
.
ÌÌP Q
ToString
ÌÌQ Y
(
ÌÌY Z
)
ÌÌZ [
;
ÌÌ[ \
MailAddress
ÔÔ 
from
ÔÔ  
=
ÔÔ! "
new
ÔÔ# &
MailAddress
ÔÔ' 2
(
ÔÔ2 3
	localMail
ÔÔ3 <
,
ÔÔ< =
$str
ÔÔ> L
)
ÔÔL M
;
ÔÔM N
MailAddress
ÚÚ 
to
ÚÚ 
=
ÚÚ  
new
ÚÚ! $
MailAddress
ÚÚ% 0
(
ÚÚ0 1
email
ÚÚ1 6
)
ÚÚ6 7
;
ÚÚ7 8
MailMessage
ıı 
msg
ıı 
=
ıı  !
new
ıı" %
MailMessage
ıı& 1
(
ıı1 2
from
ıı2 6
,
ıı6 7
to
ıı8 :
)
ıı: ;
;
ıı; <
msg
¯¯ 
.
¯¯ 
Headers
¯¯ 
.
¯¯ 
Add
¯¯ 
(
¯¯  
$str
¯¯  *
,
¯¯* +
$str
¯¯, B
)
¯¯B C
;
¯¯C D
msg
˚˚ 
.
˚˚ 

IsBodyHtml
˚˚ 
=
˚˚  
true
˚˚! %
;
˚˚% &
msg
¸¸ 
.
¸¸ 
Priority
¸¸ 
=
¸¸ 
MailPriority
¸¸ +
.
¸¸+ ,
High
¸¸, 0
;
¸¸0 1
msg
ˇˇ 
.
ˇˇ 
Subject
ˇˇ 
=
ˇˇ 
subject
ˇˇ %
;
ˇˇ% &
msg
ÇÇ 
.
ÇÇ 
Body
ÇÇ 
=
ÇÇ 
body
ÇÇ 
;
ÇÇ  
client
ââ 
.
ââ 
Send
ââ 
(
ââ 
msg
ââ 
)
ââ  
;
ââ  !
objTrace
ãã 
.
ãã 
Trace
ãã 
.
ãã 
Warn
ãã #
(
ãã# $
msg
ãã$ '
.
ãã' (
From
ãã( ,
+
ãã- .
$str
ãã/ 2
+
ãã3 4
msg
ãã5 8
.
ãã8 9
To
ãã9 ;
+
ãã< =
$str
ãã> A
+
ããB C
msg
ããD G
.
ããG H
Subject
ããH O
+
ããP Q
$str
ããR U
+
ããV W
msg
ããX [
.
ãã[ \
Body
ãã\ `
)
ãã` a
;
ããa b
}
åå 
catch
çç 
(
çç 
	Exception
çç 
err
çç  
)
çç  !
{
éé 
objTrace
èè 
.
èè 
Trace
èè 
.
èè 
Warn
èè #
(
èè# $
$str
èè$ :
+
èè; <
err
èè= @
.
èè@ A
Message
èèA H
)
èèH I
;
èèI J

ErrorClass
êê 
objErr
êê !
=
êê" #
new
êê$ '

ErrorClass
êê( 2
(
êê2 3
err
êê3 6
,
êê6 7
$str
êê8 O
)
êêO P
;
êêP Q
objErr
ëë 
.
ëë 
SendMail
ëë 
(
ëë  
)
ëë  !
;
ëë! "
}
íí 
}
îî 	
public
öö 
void
öö 
SendMail
öö 
(
öö 
string
öö #
email
öö$ )
,
öö) *
string
öö+ 1
subject
öö2 9
,
öö9 :
string
öö; A
body
ööB F
,
ööF G
bool
ööH L
htmlType
ööM U
,
ööU V
string
ööW ]
replyTo
öö^ e
)
ööe f
{
õõ 	
try
úú 
{
ùù 

SmtpClient
üü 
client
üü !
=
üü" #
new
üü$ '

SmtpClient
üü( 2
(
üü2 3"
ConfigurationManager
üü3 G
.
üüG H
AppSettings
üüH S
[
üüS T
$str
üüT `
]
üü` a
)
üüa b
;
üüb c
string
¢¢ 
	localMail
¢¢  
=
¢¢! ""
ConfigurationManager
¢¢# 7
.
¢¢7 8
AppSettings
¢¢8 C
[
¢¢C D
$str
¢¢D O
]
¢¢O P
.
¢¢P Q
ToString
¢¢Q Y
(
¢¢Y Z
)
¢¢Z [
;
¢¢[ \
MailAddress
§§ 
from
§§  
=
§§! "
new
§§# &
MailAddress
§§' 2
(
§§2 3
	localMail
§§3 <
,
§§< =
$str
§§> L
)
§§L M
;
§§M N
MailAddress
ßß 
to
ßß 
=
ßß  
new
ßß! $
MailAddress
ßß% 0
(
ßß0 1
email
ßß1 6
)
ßß6 7
;
ßß7 8
MailMessage
™™ 
msg
™™ 
=
™™  !
new
™™" %
MailMessage
™™& 1
(
™™1 2
from
™™2 6
,
™™6 7
to
™™8 :
)
™™: ;
;
™™; <
msg
≠≠ 
.
≠≠ 
Headers
≠≠ 
.
≠≠ 
Add
≠≠ 
(
≠≠  
$str
≠≠  *
,
≠≠* +
$str
≠≠, B
)
≠≠B C
;
≠≠C D
msg
∞∞ 
.
∞∞ 

IsBodyHtml
∞∞ 
=
∞∞  
true
∞∞! %
;
∞∞% &
msg
±± 
.
±± 
Priority
±± 
=
±± 
MailPriority
±± +
.
±±+ ,
High
±±, 0
;
±±0 1
msg
¥¥ 
.
¥¥ 
Subject
¥¥ 
=
¥¥ 
subject
¥¥ %
;
¥¥% &
msg
∑∑ 
.
∑∑ 
Body
∑∑ 
=
∑∑ 
body
∑∑ 
;
∑∑  
client
ææ 
.
ææ 
Send
ææ 
(
ææ 
msg
ææ 
)
ææ  
;
ææ  !
objTrace
¿¿ 
.
¿¿ 
Trace
¿¿ 
.
¿¿ 
Warn
¿¿ #
(
¿¿# $
msg
¿¿$ '
.
¿¿' (
From
¿¿( ,
+
¿¿- .
$str
¿¿/ 2
+
¿¿3 4
msg
¿¿5 8
.
¿¿8 9
To
¿¿9 ;
+
¿¿< =
$str
¿¿> A
+
¿¿B C
msg
¿¿D G
.
¿¿G H
Subject
¿¿H O
+
¿¿P Q
$str
¿¿R U
+
¿¿V W
msg
¿¿X [
.
¿¿[ \
Body
¿¿\ `
)
¿¿` a
;
¿¿a b
}
¡¡ 
catch
¬¬ 
(
¬¬ 
	Exception
¬¬ 
err
¬¬  
)
¬¬  !
{
√√ 
objTrace
ƒƒ 
.
ƒƒ 
Trace
ƒƒ 
.
ƒƒ 
Warn
ƒƒ #
(
ƒƒ# $
$str
ƒƒ$ :
+
ƒƒ; <
err
ƒƒ= @
.
ƒƒ@ A
Message
ƒƒA H
)
ƒƒH I
;
ƒƒI J

ErrorClass
≈≈ 
objErr
≈≈ !
=
≈≈" #
new
≈≈$ '

ErrorClass
≈≈( 2
(
≈≈2 3
err
≈≈3 6
,
≈≈6 7
$str
≈≈8 O
)
≈≈O P
;
≈≈P Q
objErr
∆∆ 
.
∆∆ 
SendMail
∆∆ 
(
∆∆  
)
∆∆  !
;
∆∆! "
}
«« 
}
…… 	
public
ÕÕ 
void
ÕÕ 
SendMail
ÕÕ 
(
ÕÕ 
string
ÕÕ #
email
ÕÕ$ )
,
ÕÕ) *
string
ÕÕ+ 1
subject
ÕÕ2 9
,
ÕÕ9 :
string
ÕÕ; A
body
ÕÕB F
,
ÕÕF G
int
ÕÕH K
mutipleMail
ÕÕL W
)
ÕÕW X
{
ŒŒ 	
try
œœ 
{
–– 
if
—— 
(
—— 
email
—— 
!=
—— 
$str
—— 
)
——  
{
““ 

SmtpClient
’’ 
client
’’ %
=
’’& '
new
’’( +

SmtpClient
’’, 6
(
’’6 7"
ConfigurationManager
’’7 K
.
’’K L
AppSettings
’’L W
[
’’W X
$str
’’X d
]
’’d e
)
’’e f
;
’’f g
string
ÿÿ 
	localMail
ÿÿ $
=
ÿÿ% &"
ConfigurationManager
ÿÿ' ;
.
ÿÿ; <
AppSettings
ÿÿ< G
[
ÿÿG H
$str
ÿÿH S
]
ÿÿS T
.
ÿÿT U
ToString
ÿÿU ]
(
ÿÿ] ^
)
ÿÿ^ _
;
ÿÿ_ `
MailAddress
⁄⁄ 
from
⁄⁄  $
=
⁄⁄% &
new
⁄⁄' *
MailAddress
⁄⁄+ 6
(
⁄⁄6 7
	localMail
⁄⁄7 @
,
⁄⁄@ A
$str
⁄⁄B P
)
⁄⁄P Q
;
⁄⁄Q R
MailAddress
›› 
to
››  "
=
››# $
new
››% (
MailAddress
››) 4
(
››4 5
email
››5 :
)
››: ;
;
››; <
MailMessage
‡‡ 
msg
‡‡  #
=
‡‡$ %
new
‡‡& )
MailMessage
‡‡* 5
(
‡‡5 6
from
‡‡6 :
,
‡‡: ;
to
‡‡< >
)
‡‡> ?
;
‡‡? @
string
‚‚ 
[
‚‚ 
]
‚‚ 
	emailList
‚‚ &
=
‚‚' (
email
‚‚) .
.
‚‚. /
Split
‚‚/ 4
(
‚‚4 5
$char
‚‚5 8
)
‚‚8 9
;
‚‚9 :
if
„„ 
(
„„ 
	emailList
„„ !
.
„„! "
Length
„„" (
>
„„) *
$num
„„+ ,
)
„„, -
{
‰‰ 
for
ÂÂ 
(
ÂÂ 
int
ÂÂ  
i
ÂÂ! "
=
ÂÂ# $
$num
ÂÂ% &
;
ÂÂ& '
i
ÂÂ( )
<
ÂÂ* +
	emailList
ÂÂ, 5
.
ÂÂ5 6
Length
ÂÂ6 <
;
ÂÂ< =
i
ÂÂ> ?
++
ÂÂ? A
)
ÂÂA B
{
ÊÊ 
msg
ÁÁ 
.
ÁÁ  
To
ÁÁ  "
.
ÁÁ" #
Add
ÁÁ# &
(
ÁÁ& '
new
ÁÁ' *
MailAddress
ÁÁ+ 6
(
ÁÁ6 7
	emailList
ÁÁ7 @
[
ÁÁ@ A
i
ÁÁA B
]
ÁÁB C
.
ÁÁC D
ToString
ÁÁD L
(
ÁÁL M
)
ÁÁM N
)
ÁÁN O
)
ÁÁO P
;
ÁÁP Q
}
ËË 
}
ÈÈ 
msg
ÏÏ 
.
ÏÏ 
Headers
ÏÏ 
.
ÏÏ  
Add
ÏÏ  #
(
ÏÏ# $
$str
ÏÏ$ .
,
ÏÏ. /
$str
ÏÏ0 F
)
ÏÏF G
;
ÏÏG H
msg
ÔÔ 
.
ÔÔ 

IsBodyHtml
ÔÔ "
=
ÔÔ# $
true
ÔÔ% )
;
ÔÔ) *
msg
 
.
 
Priority
  
=
! "
MailPriority
# /
.
/ 0
High
0 4
;
4 5
msg
ÛÛ 
.
ÛÛ 
Subject
ÛÛ 
=
ÛÛ  !
subject
ÛÛ" )
;
ÛÛ) *
msg
ˆˆ 
.
ˆˆ 
Body
ˆˆ 
=
ˆˆ 
body
ˆˆ #
;
ˆˆ# $
objTrace
¯¯ 
.
¯¯ 
Trace
¯¯ "
.
¯¯" #
Warn
¯¯# '
(
¯¯' (
msg
¯¯( +
.
¯¯+ ,
From
¯¯, 0
+
¯¯1 2
$str
¯¯3 6
+
¯¯7 8
msg
¯¯9 <
.
¯¯< =
To
¯¯= ?
+
¯¯@ A
$str
¯¯B E
+
¯¯F G
msg
¯¯H K
.
¯¯K L
Subject
¯¯L S
+
¯¯T U
$str
¯¯V Y
+
¯¯Z [
msg
¯¯\ _
.
¯¯_ `
Body
¯¯` d
)
¯¯d e
;
¯¯e f
client
˚˚ 
.
˚˚ 
Send
˚˚ 
(
˚˚  
msg
˚˚  #
)
˚˚# $
;
˚˚$ %
}
˝˝ 
}
˛˛ 
catch
ˇˇ 
(
ˇˇ 
	Exception
ˇˇ 
err
ˇˇ  
)
ˇˇ  !
{
ÄÄ 

ErrorClass
ÅÅ 
objErr
ÅÅ !
=
ÅÅ" #
new
ÅÅ$ '

ErrorClass
ÅÅ( 2
(
ÅÅ2 3
err
ÅÅ3 6
,
ÅÅ6 7
$str
ÅÅ8 O
)
ÅÅO P
;
ÅÅP Q
objErr
ÇÇ 
.
ÇÇ 
SendMail
ÇÇ 
(
ÇÇ  
)
ÇÇ  !
;
ÇÇ! "
}
ÉÉ 
}
ÑÑ 	
public
áá 
string
áá  
GetExcludedMembers
áá (
(
áá( )
)
áá) *
{
àà 	
string
ââ 
sql
ââ 
=
ââ 
$str
ââ 
;
ââ 
sql
ää 
=
ää 
$str
ää T
;
ääT U
return
åå 
sql
åå 
;
åå 
}
çç 	
public
îî 
void
îî 
SendMail
îî 
(
îî 
string
îî #
email
îî$ )
,
îî) *
string
îî+ 1
subject
îî2 9
,
îî9 :
string
îî; A
body
îîB F
,
îîF G
bool
îîH L
htmlType
îîM U
,
îîU V
string
îîW ]
replyTo
îî^ e
,
îîe f
string
îîg m
	fromEmail
îîn w
,
îîw x
string
îîy 
addCCîîÄ Ö
,îîÖ Ü
stringîîá ç
adBCCîîé ì
)îîì î
{
ïï 	
try
ññ 
{
óó 

SmtpClient
ôô 
client
ôô !
=
ôô" #
new
ôô$ '

SmtpClient
ôô( 2
(
ôô2 3"
ConfigurationManager
ôô3 G
.
ôôG H
AppSettings
ôôH S
[
ôôS T
$str
ôôT `
]
ôô` a
)
ôôa b
;
ôôb c
string
úú 
	localMail
úú  
=
úú! ""
ConfigurationManager
úú# 7
.
úú7 8
AppSettings
úú8 C
[
úúC D
$str
úúD O
]
úúO P
.
úúP Q
ToString
úúQ Y
(
úúY Z
)
úúZ [
;
úú[ \
MailAddress
ûû 
from
ûû  
=
ûû! "
new
ûû# &
MailAddress
ûû' 2
(
ûû2 3
	fromEmail
ûû3 <
,
ûû< =
$str
ûû> @
)
ûû@ A
;
ûûA B
MailAddress
°° 
to
°° 
=
°°  
new
°°! $
MailAddress
°°% 0
(
°°0 1
email
°°1 6
)
°°6 7
;
°°7 8
MailMessage
§§ 
msg
§§ 
=
§§  !
new
§§" %
MailMessage
§§& 1
(
§§1 2
from
§§2 6
,
§§6 7
to
§§8 :
)
§§: ;
;
§§; <
msg
ßß 
.
ßß 
Headers
ßß 
.
ßß 
Add
ßß 
(
ßß  
$str
ßß  *
,
ßß* +
replyTo
ßß, 3
)
ßß3 4
;
ßß4 5
if
™™ 
(
™™ 
addCC
™™ 
!=
™™ 
$str
™™ 
)
™™  
{
´´ 
MailAddress
¨¨ 
cc
¨¨  "
=
¨¨# $
new
¨¨% (
MailAddress
¨¨) 4
(
¨¨4 5
addCC
¨¨5 :
)
¨¨: ;
;
¨¨; <
msg
≠≠ 
.
≠≠ 
CC
≠≠ 
.
≠≠ 
Add
≠≠ 
(
≠≠ 
cc
≠≠ !
)
≠≠! "
;
≠≠" #
}
ÆÆ 
if
±± 
(
±± 
adBCC
±± 
!=
±± 
$str
±± 
)
±±  
{
≤≤ 
MailAddress
≥≥ 
bcc
≥≥  #
=
≥≥$ %
new
≥≥& )
MailAddress
≥≥* 5
(
≥≥5 6
adBCC
≥≥6 ;
)
≥≥; <
;
≥≥< =
msg
¥¥ 
.
¥¥ 
Bcc
¥¥ 
.
¥¥ 
Add
¥¥ 
(
¥¥  
bcc
¥¥  #
)
¥¥# $
;
¥¥$ %
}
µµ 
msg
∏∏ 
.
∏∏ 

IsBodyHtml
∏∏ 
=
∏∏  
true
∏∏! %
;
∏∏% &
msg
ππ 
.
ππ 
Priority
ππ 
=
ππ 
MailPriority
ππ +
.
ππ+ ,
High
ππ, 0
;
ππ0 1
msg
ºº 
.
ºº 
Subject
ºº 
=
ºº 
subject
ºº %
;
ºº% &
msg
øø 
.
øø 
Body
øø 
=
øø 
body
øø 
;
øø  
client
∆∆ 
.
∆∆ 
Send
∆∆ 
(
∆∆ 
msg
∆∆ 
)
∆∆  
;
∆∆  !
objTrace
»» 
.
»» 
Trace
»» 
.
»» 
Warn
»» #
(
»»# $
msg
»»$ '
.
»»' (
From
»»( ,
+
»»- .
$str
»»/ 2
+
»»3 4
msg
»»5 8
.
»»8 9
To
»»9 ;
+
»»< =
$str
»»> A
+
»»B C
msg
»»D G
.
»»G H
Subject
»»H O
+
»»P Q
$str
»»R U
+
»»V W
msg
»»X [
.
»»[ \
Body
»»\ `
)
»»` a
;
»»a b
}
…… 
catch
   
(
   
	Exception
   
err
    
)
    !
{
ÀÀ 
objTrace
ÃÃ 
.
ÃÃ 
Trace
ÃÃ 
.
ÃÃ 
Warn
ÃÃ #
(
ÃÃ# $
$str
ÃÃ$ :
+
ÃÃ; <
err
ÃÃ= @
.
ÃÃ@ A
Message
ÃÃA H
)
ÃÃH I
;
ÃÃI J

ErrorClass
ÕÕ 
objErr
ÕÕ !
=
ÕÕ" #
new
ÕÕ$ '

ErrorClass
ÕÕ( 2
(
ÕÕ2 3
err
ÕÕ3 6
,
ÕÕ6 7
$str
ÕÕ8 O
)
ÕÕO P
;
ÕÕP Q
objErr
ŒŒ 
.
ŒŒ 
SendMail
ŒŒ 
(
ŒŒ  
)
ŒŒ  !
;
ŒŒ! "
}
œœ 
}
—— 	
public
”” 
static
”” 
string
”” 
FormatNumeric
”” *
(
””* +
string
””+ 1
numberToFormat
””2 @
)
””@ A
{
‘‘ 	
string
’’ 
	formatted
’’ 
=
’’ 
$str
’’ !
;
’’! "
int
÷÷ 

breakPoint
÷÷ 
=
÷÷ 
$num
÷÷ 
;
÷÷ 
for
ÿÿ 
(
ÿÿ 
int
ÿÿ 
i
ÿÿ 
=
ÿÿ 
numberToFormat
ÿÿ '
.
ÿÿ' (
Length
ÿÿ( .
-
ÿÿ/ 0
$num
ÿÿ1 2
;
ÿÿ2 3
i
ÿÿ4 5
>=
ÿÿ6 8
$num
ÿÿ9 :
;
ÿÿ: ;
i
ÿÿ< =
--
ÿÿ= ?
)
ÿÿ? @
{
ŸŸ 
	formatted
⁄⁄ 
=
⁄⁄ 
numberToFormat
⁄⁄ *
[
⁄⁄* +
i
⁄⁄+ ,
]
⁄⁄, -
.
⁄⁄- .
ToString
⁄⁄. 6
(
⁄⁄6 7
)
⁄⁄7 8
+
⁄⁄9 :
	formatted
⁄⁄; D
;
⁄⁄D E
if
€€ 
(
€€ 
(
€€ 
numberToFormat
€€ #
.
€€# $
Length
€€$ *
-
€€+ ,
i
€€- .
)
€€. /
==
€€0 2

breakPoint
€€3 =
&&
€€> @
numberToFormat
€€A O
.
€€O P
Length
€€P V
>
€€W X

breakPoint
€€Y c
)
€€c d
{
‹‹ 
	formatted
ﬁﬁ 
=
ﬁﬁ 
$str
ﬁﬁ  #
+
ﬁﬁ$ %
	formatted
ﬁﬁ& /
;
ﬁﬁ/ 0

breakPoint
ﬂﬂ 
+=
ﬂﬂ !
$num
ﬂﬂ" #
;
ﬂﬂ# $
}
‡‡ 
}
·· 
return
„„ 
	formatted
„„ 
;
„„ 
}
‰‰ 	
public
ÈÈ 
static
ÈÈ 
void
ÈÈ 
SqlError
ÈÈ #
(
ÈÈ# $
SqlException
ÈÈ$ 0
err
ÈÈ1 4
)
ÈÈ4 5
{
ÍÍ 	
HttpContext
ÎÎ 
.
ÎÎ 
Current
ÎÎ 
.
ÎÎ  
Trace
ÎÎ  %
.
ÎÎ% &
Warn
ÎÎ& *
(
ÎÎ* +
$str
ÎÎ+ 2
+
ÎÎ3 4
err
ÎÎ5 8
.
ÎÎ8 9
Message
ÎÎ9 @
+
ÎÎA B
err
ÎÎC F
.
ÎÎF G
Source
ÎÎG M
)
ÎÎM N
;
ÎÎN O

ErrorClass
ÏÏ 
objErr
ÏÏ 
=
ÏÏ 
new
ÏÏ  #

ErrorClass
ÏÏ$ .
(
ÏÏ. /
err
ÏÏ/ 2
,
ÏÏ2 3
HttpContext
ÏÏ4 ?
.
ÏÏ? @
Current
ÏÏ@ G
.
ÏÏG H
Request
ÏÏH O
.
ÏÏO P
ServerVariables
ÏÏP _
[
ÏÏ_ `
$str
ÏÏ` e
]
ÏÏe f
)
ÏÏf g
;
ÏÏg h
objErr
ÌÌ 
.
ÌÌ 
SendMail
ÌÌ 
(
ÌÌ 
)
ÌÌ 
;
ÌÌ 
}
ÓÓ 	
public
ÛÛ 
static
ÛÛ 
void
ÛÛ 
ExceptionError
ÛÛ )
(
ÛÛ) *
	Exception
ÛÛ* 3
err
ÛÛ4 7
)
ÛÛ7 8
{
ÙÙ 	
HttpContext
ıı 
.
ıı 
Current
ıı 
.
ıı  
Trace
ıı  %
.
ıı% &
Warn
ıı& *
(
ıı* +
err
ıı+ .
.
ıı. /
Message
ıı/ 6
+
ıı7 8
err
ıı9 <
.
ıı< =
Source
ıı= C
)
ııC D
;
ııD E

ErrorClass
ˆˆ 
objErr
ˆˆ 
=
ˆˆ 
new
ˆˆ  #

ErrorClass
ˆˆ$ .
(
ˆˆ. /
err
ˆˆ/ 2
,
ˆˆ2 3
HttpContext
ˆˆ4 ?
.
ˆˆ? @
Current
ˆˆ@ G
.
ˆˆG H
Request
ˆˆH O
.
ˆˆO P
ServerVariables
ˆˆP _
[
ˆˆ_ `
$str
ˆˆ` e
]
ˆˆe f
)
ˆˆf g
;
ˆˆg h
objErr
˜˜ 
.
˜˜ 
SendMail
˜˜ 
(
˜˜ 
)
˜˜ 
;
˜˜ 
}
¯¯ 	
public
˝˝ 
static
˝˝ 
string
˝˝ 
GetEMI
˝˝ #
(
˝˝# $
int
˝˝$ '
	bikePrice
˝˝( 1
)
˝˝1 2
{
˛˛ 	
string
ÄÄ 
emi
ÄÄ 
=
ÄÄ 
$str
ÄÄ 
;
ÄÄ 
try
ÅÅ 
{
ÇÇ 
double
ÉÉ 

loanAmount
ÉÉ !
=
ÉÉ" #
	bikePrice
ÉÉ$ -
*
ÉÉ. /
$num
ÉÉ0 3
;
ÉÉ3 4
double
ÑÑ 
rate
ÑÑ 
=
ÑÑ 
$num
ÑÑ  
;
ÑÑ  !
double
ÖÖ 
months
ÖÖ 
=
ÖÖ 
$num
ÖÖ  "
;
ÖÖ" #
double
áá 
interest
áá 
=
áá  !
rate
áá" &
/
áá' (
(
áá) *
$num
áá* ,
*
áá- .
$num
áá/ 2
)
áá2 3
;
áá3 4
double
àà 
finalEmi
àà 
=
àà  !
(
àà" #

loanAmount
àà# -
*
àà. /
interest
àà0 8
*
àà9 :
Math
àà; ?
.
àà? @
Pow
àà@ C
(
ààC D
$num
ààD E
+
ààF G
interest
ààH P
,
ààP Q
months
ààR X
)
ààX Y
)
ààY Z
/
àà[ \
(
àà] ^
Math
àà^ b
.
ààb c
Pow
ààc f
(
ààf g
$num
ààg h
+
àài j
interest
ààk s
,
ààs t
months
ààu {
)
àà{ |
-
àà} ~
$numàà Ä
)ààÄ Å
;ààÅ Ç
emi
ää 
=
ää 
Math
ää 
.
ää 
Round
ää  
(
ää  !
finalEmi
ää! )
,
ää) *
$num
ää+ ,
)
ää, -
.
ää- .
ToString
ää. 6
(
ää6 7
)
ää7 8
;
ää8 9
}
ãã 
catch
åå 
(
åå 
	Exception
åå 
err
åå  
)
åå  !
{
çç 
HttpContext
éé 
.
éé 
Current
éé #
.
éé# $
Trace
éé$ )
.
éé) *
Warn
éé* .
(
éé. /
err
éé/ 2
.
éé2 3
Message
éé3 :
)
éé: ;
;
éé; <

ErrorClass
èè 
objErr
èè !
=
èè" #
new
èè$ '

ErrorClass
èè( 2
(
èè2 3
err
èè3 6
,
èè6 7
HttpContext
èè8 C
.
èèC D
Current
èèD K
.
èèK L
Request
èèL S
.
èèS T
ServerVariables
èèT c
[
èèc d
$str
èèd i
]
èèi j
)
èèj k
;
èèk l
objErr
êê 
.
êê 
SendMail
êê 
(
êê  
)
êê  !
;
êê! "
}
ëë 
return
ìì 
emi
ìì 
;
ìì 
}
îî 	
public
óó 
static
óó 
string
óó 
GetEMI
óó #
(
óó# $
int
óó$ '
	bikePrice
óó( 1
,
óó1 2
double
óó3 9
months
óó: @
,
óó@ A
float
óóB G
percent
óóH O
)
óóO P
{
òò 	
string
öö 
emi
öö 
=
öö 
$str
öö 
;
öö 
try
õõ 
{
úú 
double
ùù 

loanAmount
ùù !
=
ùù" #
	bikePrice
ùù$ -
*
ùù. /
percent
ùù0 7
;
ùù7 8
double
ûû 
rate
ûû 
=
ûû 
$num
ûû  
;
ûû  !
double
†† 
interest
†† 
=
††  !
rate
††" &
/
††' (
(
††) *
$num
††* ,
*
††- .
$num
††/ 2
)
††2 3
;
††3 4
double
¢¢ 
finalEmi
¢¢ 
=
¢¢  !
(
¢¢" #

loanAmount
¢¢# -
*
¢¢. /
interest
¢¢0 8
*
¢¢9 :
Math
¢¢; ?
.
¢¢? @
Pow
¢¢@ C
(
¢¢C D
$num
¢¢D E
+
¢¢F G
interest
¢¢H P
,
¢¢P Q
months
¢¢R X
)
¢¢X Y
)
¢¢Y Z
/
¢¢[ \
(
¢¢] ^
Math
¢¢^ b
.
¢¢b c
Pow
¢¢c f
(
¢¢f g
$num
¢¢g h
+
¢¢i j
interest
¢¢k s
,
¢¢s t
months
¢¢u {
)
¢¢{ |
-
¢¢} ~
$num¢¢ Ä
)¢¢Ä Å
;¢¢Å Ç
emi
§§ 
=
§§ 
Math
§§ 
.
§§ 
Round
§§  
(
§§  !
finalEmi
§§! )
,
§§) *
$num
§§+ ,
)
§§, -
.
§§- .
ToString
§§. 6
(
§§6 7
)
§§7 8
;
§§8 9
}
•• 
catch
¶¶ 
(
¶¶ 
	Exception
¶¶ 
err
¶¶  
)
¶¶  !
{
ßß 
HttpContext
®® 
.
®® 
Current
®® #
.
®®# $
Trace
®®$ )
.
®®) *
Warn
®®* .
(
®®. /
err
®®/ 2
.
®®2 3
Message
®®3 :
)
®®: ;
;
®®; <

ErrorClass
©© 
objErr
©© !
=
©©" #
new
©©$ '

ErrorClass
©©( 2
(
©©2 3
err
©©3 6
,
©©6 7
HttpContext
©©8 C
.
©©C D
Current
©©D K
.
©©K L
Request
©©L S
.
©©S T
ServerVariables
©©T c
[
©©c d
$str
©©d i
]
©©i j
)
©©j k
;
©©k l
objErr
™™ 
.
™™ 
SendMail
™™ 
(
™™  
)
™™  !
;
™™! "
}
´´ 
return
≠≠ 
emi
≠≠ 
;
≠≠ 
}
ÆÆ 	
public
±± 
static
±± 
string
±± 
GetEMI
±± #
(
±±# $
int
±±$ '
	bikePrice
±±( 1
,
±±1 2
int
±±3 6
months
±±7 =
,
±±= >
double
±±? E
percent
±±F M
,
±±M N
double
±±O U
rate
±±V Z
)
±±Z [
{
≤≤ 	
string
¥¥ 
emi
¥¥ 
=
¥¥ 
$str
¥¥ 
;
¥¥ 
try
µµ 
{
∂∂ 
if
∑∑ 
(
∑∑ 
percent
∑∑ 
>
∑∑ 
$num
∑∑ 
)
∑∑  
percent
∑∑! (
=
∑∑) *
percent
∑∑+ 2
/
∑∑3 4
$num
∑∑5 8
;
∑∑8 9
double
ππ 

loanAmount
ππ !
=
ππ" #
	bikePrice
ππ$ -
*
ππ. /
percent
ππ0 7
;
ππ7 8
double
ªª 
interest
ªª 
=
ªª  !
rate
ªª" &
/
ªª' (
(
ªª) *
$num
ªª* ,
*
ªª- .
$num
ªª/ 2
)
ªª2 3
;
ªª3 4
double
ΩΩ 
finalEmi
ΩΩ 
=
ΩΩ  !
(
ΩΩ" #

loanAmount
ΩΩ# -
*
ΩΩ. /
interest
ΩΩ0 8
*
ΩΩ9 :
Math
ΩΩ; ?
.
ΩΩ? @
Pow
ΩΩ@ C
(
ΩΩC D
$num
ΩΩD E
+
ΩΩF G
interest
ΩΩH P
,
ΩΩP Q
months
ΩΩR X
)
ΩΩX Y
)
ΩΩY Z
/
ΩΩ[ \
(
ΩΩ] ^
Math
ΩΩ^ b
.
ΩΩb c
Pow
ΩΩc f
(
ΩΩf g
$num
ΩΩg h
+
ΩΩi j
interest
ΩΩk s
,
ΩΩs t
months
ΩΩu {
)
ΩΩ{ |
-
ΩΩ} ~
$numΩΩ Ä
)ΩΩÄ Å
;ΩΩÅ Ç
emi
øø 
=
øø 
Math
øø 
.
øø 
Round
øø  
(
øø  !
finalEmi
øø! )
,
øø) *
$num
øø+ ,
)
øø, -
.
øø- .
ToString
øø. 6
(
øø6 7
)
øø7 8
;
øø8 9
}
¡¡ 
catch
¬¬ 
(
¬¬ 
	Exception
¬¬ 
err
¬¬  
)
¬¬  !
{
√√ 
HttpContext
ƒƒ 
.
ƒƒ 
Current
ƒƒ #
.
ƒƒ# $
Trace
ƒƒ$ )
.
ƒƒ) *
Warn
ƒƒ* .
(
ƒƒ. /
err
ƒƒ/ 2
.
ƒƒ2 3
Message
ƒƒ3 :
)
ƒƒ: ;
;
ƒƒ; <

ErrorClass
≈≈ 
objErr
≈≈ !
=
≈≈" #
new
≈≈$ '

ErrorClass
≈≈( 2
(
≈≈2 3
err
≈≈3 6
,
≈≈6 7
HttpContext
≈≈8 C
.
≈≈C D
Current
≈≈D K
.
≈≈K L
Request
≈≈L S
.
≈≈S T
ServerVariables
≈≈T c
[
≈≈c d
$str
≈≈d i
]
≈≈i j
)
≈≈j k
;
≈≈k l
objErr
∆∆ 
.
∆∆ 
SendMail
∆∆ 
(
∆∆  
)
∆∆  !
;
∆∆! "
}
«« 
return
…… 
emi
…… 
;
…… 
}
   	
public
ÃÃ 
static
ÃÃ 
string
ÃÃ 
GetRateImage
ÃÃ )
(
ÃÃ) *
double
ÃÃ* 0
value
ÃÃ1 6
)
ÃÃ6 7
{
ÕÕ 	
string
ŒŒ 
oneImg
ŒŒ 
=
ŒŒ 
$str
ŒŒ n
;
ŒŒn o
string
œœ 
zeroImg
œœ 
=
œœ 
$str
œœ o
;
œœo p
string
–– 
halfImg
–– 
=
–– 
$str
–– r
;
––r s
StringBuilder
““ 
sb
““ 
=
““ 
new
““ "
StringBuilder
““# 0
(
““0 1
)
““1 2
;
““2 3
int
”” 
absVal
”” 
=
”” 
(
”” 
int
”” 
)
”” 
Math
”” "
.
””" #
Floor
””# (
(
””( )
value
””) .
)
””. /
;
””/ 0
int
’’ 
i
’’ 
;
’’ 
for
÷÷ 
(
÷÷ 
i
÷÷ 
=
÷÷ 
$num
÷÷ 
;
÷÷ 
i
÷÷ 
<
÷÷ 
absVal
÷÷ "
;
÷÷" #
i
÷÷$ %
++
÷÷% '
)
÷÷' (
sb
◊◊ 
.
◊◊ 
Append
◊◊ 
(
◊◊ 
oneImg
◊◊  
)
◊◊  !
;
◊◊! "
if
ŸŸ 
(
ŸŸ 
value
ŸŸ 
>
ŸŸ 
absVal
ŸŸ 
)
ŸŸ 
sb
⁄⁄ 
.
⁄⁄ 
Append
⁄⁄ 
(
⁄⁄ 
halfImg
⁄⁄ !
)
⁄⁄! "
;
⁄⁄" #
else
€€ 
i
‹‹ 
--
‹‹ 
;
‹‹ 
for
ﬁﬁ 
(
ﬁﬁ 
int
ﬁﬁ 
j
ﬁﬁ 
=
ﬁﬁ 
$num
ﬁﬁ 
;
ﬁﬁ 
j
ﬁﬁ 
>
ﬁﬁ 
i
ﬁﬁ  !
+
ﬁﬁ" #
$num
ﬁﬁ$ %
;
ﬁﬁ% &
j
ﬁﬁ' (
--
ﬁﬁ( *
)
ﬁﬁ* +
sb
ﬂﬂ 
.
ﬂﬂ 
Append
ﬂﬂ 
(
ﬂﬂ 
zeroImg
ﬂﬂ !
)
ﬂﬂ! "
;
ﬂﬂ" #
return
·· 
sb
·· 
.
·· 
ToString
·· 
(
·· 
)
··  
;
··  !
}
‚‚ 	
public
‰‰ 
void
‰‰ *
ExpireNeedContactInformation
‰‰ 0
(
‰‰0 1
)
‰‰1 2
{
ÂÂ 	
HttpContext
ÊÊ 
.
ÊÊ 
Current
ÊÊ 
.
ÊÊ  
Response
ÊÊ  (
.
ÊÊ( )
Cookies
ÊÊ) 0
[
ÊÊ0 1
$str
ÊÊ1 I
]
ÊÊI J
.
ÊÊJ K
Expires
ÊÊK R
=
ÊÊS T
DateTime
ÊÊU ]
.
ÊÊ] ^
Now
ÊÊ^ a
.
ÊÊa b
AddYears
ÊÊb j
(
ÊÊj k
-
ÊÊk l
$num
ÊÊl m
)
ÊÊm n
;
ÊÊn o
}
ÁÁ 	
public
ÍÍ 
static
ÍÍ 
string
ÍÍ  
CustomerLoginEmail
ÍÍ /
{
ÎÎ 	
get
ÏÏ 
{
ÌÌ 
string
ÓÓ 
value
ÓÓ 
=
ÓÓ 
$str
ÓÓ !
;
ÓÓ! "
if
 
(
 
HttpContext
 
.
  
Current
  '
.
' (
Request
( /
.
/ 0
Cookies
0 7
[
7 8
$str
8 L
]
L M
!=
N P
null
Q U
&&
V X
HttpContext
ÒÒ 
.
ÒÒ  
Current
ÒÒ  '
.
ÒÒ' (
Request
ÒÒ( /
.
ÒÒ/ 0
Cookies
ÒÒ0 7
[
ÒÒ7 8
$str
ÒÒ8 L
]
ÒÒL M
.
ÒÒM N
Value
ÒÒN S
.
ÒÒS T
ToString
ÒÒT \
(
ÒÒ\ ]
)
ÒÒ] ^
!=
ÒÒ_ a
$str
ÒÒb d
)
ÒÒd e
{
ÚÚ 
value
ÛÛ 
=
ÛÛ 
HttpContext
ÛÛ '
.
ÛÛ' (
Current
ÛÛ( /
.
ÛÛ/ 0
Request
ÛÛ0 7
.
ÛÛ7 8
Cookies
ÛÛ8 ?
[
ÛÛ? @
$str
ÛÛ@ T
]
ÛÛT U
.
ÛÛU V
Value
ÛÛV [
.
ÛÛ[ \
ToString
ÛÛ\ d
(
ÛÛd e
)
ÛÛe f
;
ÛÛf g
}
ÙÙ 
else
ıı 
{
ˆˆ 
value
˜˜ 
=
˜˜ 
$str
˜˜ 
;
˜˜ 
}
¯¯ 
return
˙˙ 
value
˙˙ 
;
˙˙ 
}
˚˚ 
set
¸¸ 
{
˝˝ 

HttpCookie
ˇˇ 
	objCookie
ˇˇ $
;
ˇˇ$ %
	objCookie
ÄÄ 
=
ÄÄ 
new
ÄÄ 

HttpCookie
ÄÄ  *
(
ÄÄ* +
$str
ÄÄ+ ?
)
ÄÄ? @
;
ÄÄ@ A
	objCookie
ÅÅ 
.
ÅÅ 
Value
ÅÅ 
=
ÅÅ  !
value
ÅÅ" '
;
ÅÅ' (
HttpContext
ÇÇ 
.
ÇÇ 
Current
ÇÇ #
.
ÇÇ# $
Response
ÇÇ$ ,
.
ÇÇ, -
Cookies
ÇÇ- 4
.
ÇÇ4 5
Add
ÇÇ5 8
(
ÇÇ8 9
	objCookie
ÇÇ9 B
)
ÇÇB C
;
ÇÇC D
}
ÉÉ 
}
ÑÑ 	
public
áá 
static
áá 
string
áá 
ParseMobileNumber
áá .
(
áá. /
string
áá/ 5
input
áá6 ;
)
áá; <
{
àà 	
char
ää 
[
ää 
]
ää 
chars
ää 
=
ää 
input
ää  
.
ää  !
ToCharArray
ää! ,
(
ää, -
)
ää- .
;
ää. /
string
ãã 
raw
ãã 
=
ãã 
$str
ãã 
;
ãã 
for
çç 
(
çç 
int
çç 
i
çç 
=
çç 
$num
çç 
;
çç 
i
çç 
<
çç 
chars
çç  %
.
çç% &
Length
çç& ,
;
çç, -
i
çç. /
++
çç/ 1
)
çç1 2
{
éé 
if
èè 
(
èè 
Regex
èè 
.
èè 
IsMatch
èè !
(
èè! "
chars
èè" '
[
èè' (
i
èè( )
]
èè) *
.
èè* +
ToString
èè+ 3
(
èè3 4
)
èè4 5
,
èè5 6
$str
èè7 A
)
èèA B
==
èèC E
true
èèF J
)
èèJ K
{
êê 
raw
ëë 
+=
ëë 
chars
ëë  
[
ëë  !
i
ëë! "
]
ëë" #
.
ëë# $
ToString
ëë$ ,
(
ëë, -
)
ëë- .
;
ëë. /
}
íí 
}
ìì 
if
ññ 
(
ññ 
raw
ññ 
.
ññ 
Length
ññ 
<
ññ 
$num
ññ 
)
ññ  
return
óó 
$str
óó 
;
óó 
if
öö 
(
öö 
raw
öö 
.
öö 
Length
öö 
>
öö 
$num
öö 
)
öö  
raw
õõ 
=
õõ 
raw
õõ 
.
õõ 
	Substring
õõ #
(
õõ# $
raw
õõ$ '
.
õõ' (
Length
õõ( .
-
õõ/ 0
$num
õõ1 3
,
õõ3 4
$num
õõ5 7
)
õõ7 8
;
õõ8 9
return
ûû 
raw
ûû 
;
ûû 
}
üü 	
public
°° 
static
°° 
bool
°° (
CheckIsDealerFromProfileNo
°° 5
(
°°5 6
string
°°6 <
	profileNo
°°= F
)
°°F G
{
¢¢ 	
bool
££ 
retVal
££ 
=
££ 
true
££ 
;
££ 
switch
•• 
(
•• 
	profileNo
•• 
.
•• 
	Substring
•• '
(
••' (
$num
••( )
,
••) *
$num
••+ ,
)
••, -
.
••- .
ToUpper
••. 5
(
••5 6
)
••6 7
)
••7 8
{
¶¶ 
case
ßß 
$str
ßß 
:
ßß 
retVal
®® 
=
®® 
true
®® !
;
®®! "
break
©© 
;
©© 
case
´´ 
$str
´´ 
:
´´ 
retVal
¨¨ 
=
¨¨ 
false
¨¨ "
;
¨¨" #
break
≠≠ 
;
≠≠ 
default
ØØ 
:
ØØ 
retVal
∞∞ 
=
∞∞ 
true
∞∞ !
;
∞∞! "
break
±± 
;
±± 
}
≤≤ 
return
¥¥ 
retVal
¥¥ 
;
¥¥ 
}
µµ 	
public
∑∑ 
static
∑∑ 
string
∑∑ 
GetProfileNo
∑∑ )
(
∑∑) *
string
∑∑* 0
	profileNo
∑∑1 :
)
∑∑: ;
{
∏∏ 	
string
ππ 
retVal
ππ 
=
ππ 
$str
ππ 
;
ππ 
switch
ªª 
(
ªª 
	profileNo
ªª 
.
ªª 
	Substring
ªª '
(
ªª' (
$num
ªª( )
,
ªª) *
$num
ªª+ ,
)
ªª, -
.
ªª- .
ToUpper
ªª. 5
(
ªª5 6
)
ªª6 7
)
ªª7 8
{
ºº 
case
ΩΩ 
$str
ΩΩ 
:
ΩΩ 
retVal
ææ 
=
ææ 
	profileNo
ææ &
.
ææ& '
	Substring
ææ' 0
(
ææ0 1
$num
ææ1 2
,
ææ2 3
	profileNo
ææ4 =
.
ææ= >
Length
ææ> D
-
ææE F
$num
ææG H
)
ææH I
;
ææI J
break
øø 
;
øø 
case
¡¡ 
$str
¡¡ 
:
¡¡ 
retVal
¬¬ 
=
¬¬ 
	profileNo
¬¬ &
.
¬¬& '
	Substring
¬¬' 0
(
¬¬0 1
$num
¬¬1 2
,
¬¬2 3
	profileNo
¬¬4 =
.
¬¬= >
Length
¬¬> D
-
¬¬E F
$num
¬¬G H
)
¬¬H I
;
¬¬I J
break
√√ 
;
√√ 
default
≈≈ 
:
≈≈ 
retVal
∆∆ 
=
∆∆ 
	profileNo
∆∆ &
;
∆∆& '
break
«« 
;
«« 
}
»» 
return
   
retVal
   
;
   
}
ÀÀ 	
public
ññ 
string
ññ 
	GetCityId
ññ 
(
ññ  
)
ññ  !
{
óó 	
string
òò 
cityId
òò 
=
òò 
$str
òò 
;
òò  
if
öö 
(
öö 
HttpContext
öö 
.
öö 
Current
öö #
.
öö# $
Request
öö$ +
.
öö+ ,
Cookies
öö, 3
[
öö3 4
$str
öö4 B
]
ööB C
!=
ööD F
null
ööG K
&&
ööL N
HttpContext
õõ 
.
õõ 
Current
õõ #
.
õõ# $
Request
õõ$ +
.
õõ+ ,
Cookies
õõ, 3
[
õõ3 4
$str
õõ4 B
]
õõB C
.
õõC D
Value
õõD I
.
õõI J
ToString
õõJ R
(
õõR S
)
õõS T
!=
õõU W
$str
õõX Z
)
õõZ [
{
úú 
cityId
ùù 
=
ùù 
HttpContext
ùù $
.
ùù$ %
Current
ùù% ,
.
ùù, -
Request
ùù- 4
.
ùù4 5
Cookies
ùù5 <
[
ùù< =
$str
ùù= K
]
ùùK L
.
ùùL M
Value
ùùM R
.
ùùR S
ToString
ùùS [
(
ùù[ \
)
ùù\ ]
;
ùù] ^
}
ûû 
else
üü 
{
†† 
cityId
°° 
=
°° 
$str
°° 
;
°° 
}
¢¢ 
return
§§ 
cityId
§§ 
;
§§ 
}
•• 	
public
©© 
static
©© 
void
©© 
	SetCityId
©© $
(
©©$ %
string
©©% +
cityId
©©, 2
)
©©2 3
{
™™ 	

HttpCookie
¨¨ 
	objCookie
¨¨  
;
¨¨  !
	objCookie
≠≠ 
=
≠≠ 
new
≠≠ 

HttpCookie
≠≠ &
(
≠≠& '
$str
≠≠' 5
)
≠≠5 6
;
≠≠6 7
	objCookie
ÆÆ 
.
ÆÆ 
Value
ÆÆ 
=
ÆÆ 
cityId
ÆÆ $
;
ÆÆ$ %
HttpContext
ØØ 
.
ØØ 
Current
ØØ 
.
ØØ  
Response
ØØ  (
.
ØØ( )
Cookies
ØØ) 0
.
ØØ0 1
Add
ØØ1 4
(
ØØ4 5
	objCookie
ØØ5 >
)
ØØ> ?
;
ØØ? @
}
∞∞ 	
public
¥¥ 
string
¥¥ 
GetCityDistance
¥¥ %
(
¥¥% &
)
¥¥& '
{
µµ 	
string
∂∂ 
cityDist
∂∂ 
=
∂∂ 
$str
∂∂ !
;
∂∂! "
if
∏∏ 
(
∏∏ 
HttpContext
∏∏ 
.
∏∏ 
Current
∏∏ #
.
∏∏# $
Request
∏∏$ +
.
∏∏+ ,
Cookies
∏∏, 3
[
∏∏3 4
$str
∏∏4 J
]
∏∏J K
!=
∏∏L N
null
∏∏O S
&&
∏∏T V
HttpContext
ππ 
.
ππ 
Current
ππ #
.
ππ# $
Request
ππ$ +
.
ππ+ ,
Cookies
ππ, 3
[
ππ3 4
$str
ππ4 J
]
ππJ K
.
ππK L
Value
ππL Q
.
ππQ R
ToString
ππR Z
(
ππZ [
)
ππ[ \
!=
ππ] _
$str
ππ` b
)
ππb c
{
∫∫ 
cityDist
ªª 
=
ªª 
HttpContext
ªª &
.
ªª& '
Current
ªª' .
.
ªª. /
Request
ªª/ 6
.
ªª6 7
Cookies
ªª7 >
[
ªª> ?
$str
ªª? U
]
ªªU V
.
ªªV W
Value
ªªW \
.
ªª\ ]
ToString
ªª] e
(
ªªe f
)
ªªf g
;
ªªg h
}
ºº 
else
ΩΩ 
{
ææ 
cityDist
øø 
=
øø 
$str
øø 
;
øø  
}
¿¿ 
return
¬¬ 
cityDist
¬¬ 
;
¬¬ 
}
√√ 	
public
«« 
static
«« 
void
«« 
SetCityDistance
«« *
(
««* +
string
««+ 1
cityDist
««2 :
)
««: ;
{
»» 	

HttpCookie
   
	objCookie
    
;
    !
	objCookie
ÀÀ 
=
ÀÀ 
new
ÀÀ 

HttpCookie
ÀÀ &
(
ÀÀ& '
$str
ÀÀ' =
)
ÀÀ= >
;
ÀÀ> ?
	objCookie
ÃÃ 
.
ÃÃ 
Value
ÃÃ 
=
ÃÃ 
cityDist
ÃÃ &
;
ÃÃ& '
HttpContext
ÕÕ 
.
ÕÕ 
Current
ÕÕ 
.
ÕÕ  
Response
ÕÕ  (
.
ÕÕ( )
Cookies
ÕÕ) 0
.
ÕÕ0 1
Add
ÕÕ1 4
(
ÕÕ4 5
	objCookie
ÕÕ5 >
)
ÕÕ> ?
;
ÕÕ? @
}
ŒŒ 	
private
–– 
static
–– 
double
–– 
lattSecPerKm
–– *
=
––+ ,
$num
––- 8
;
––8 9
private
—— 
static
—— 
double
—— 
longSecPerKm
—— *
=
——+ ,
$num
——- 8
;
——8 9
public
‘‘ 
static
‘‘ 
double
‘‘ 
GetLattitude
‘‘ )
(
‘‘) *
int
‘‘* -
diffKm
‘‘. 4
)
‘‘4 5
{
’’ 	
return
÷÷ 
lattSecPerKm
÷÷ 
*
÷÷  !
diffKm
÷÷" (
;
÷÷( )
}
◊◊ 	
public
ŸŸ 
static
ŸŸ 
double
ŸŸ 
GetLongitude
ŸŸ )
(
ŸŸ) *
int
ŸŸ* -
diffKm
ŸŸ. 4
)
ŸŸ4 5
{
⁄⁄ 	
return
€€ 
longSecPerKm
€€ 
*
€€  !
diffKm
€€" (
;
€€( )
}
‹‹ 	
public
‚‚ 
void
‚‚ 
UpdateContents
‚‚ "
(
‚‚" #
DropDownList
‚‚# /
drp
‚‚0 3
,
‚‚3 4
string
‚‚5 ;
content
‚‚< C
,
‚‚C D
string
‚‚E K
selectedValue
‚‚L Y
)
‚‚Y Z
{
„„ 	
UpdateContents
‰‰ 
(
‰‰ 
drp
‰‰ 
,
‰‰ 
content
‰‰  '
,
‰‰' (
selectedValue
‰‰) 6
,
‰‰6 7
$str
‰‰8 =
)
‰‰= >
;
‰‰> ?
}
ÂÂ 	
public
ÈÈ 
void
ÈÈ 
UpdateContents
ÈÈ "
(
ÈÈ" #
DropDownList
ÈÈ# /
drp
ÈÈ0 3
,
ÈÈ3 4
string
ÈÈ5 ;
content
ÈÈ< C
,
ÈÈC D
string
ÈÈE K
selectedValue
ÈÈL Y
,
ÈÈY Z
string
ÈÈ[ a

selectName
ÈÈb l
)
ÈÈl m
{
ÍÍ 	
drp
ÎÎ 
.
ÎÎ 
Items
ÎÎ 
.
ÎÎ 
Clear
ÎÎ 
(
ÎÎ 
)
ÎÎ 
;
ÎÎ 
drp
ÏÏ 
.
ÏÏ 
Enabled
ÏÏ 
=
ÏÏ 
true
ÏÏ 
;
ÏÏ 
drp
ÔÔ 
.
ÔÔ 
Items
ÔÔ 
.
ÔÔ 
Add
ÔÔ 
(
ÔÔ 
new
ÔÔ 
ListItem
ÔÔ &
(
ÔÔ& '

selectName
ÔÔ' 1
,
ÔÔ1 2
$str
ÔÔ3 6
)
ÔÔ6 7
)
ÔÔ7 8
;
ÔÔ8 9
if
ÒÒ 
(
ÒÒ 
content
ÒÒ 
!=
ÒÒ 
$str
ÒÒ 
)
ÒÒ 
{
ÚÚ 
string
ÛÛ 
[
ÛÛ 
]
ÛÛ 
	listItems
ÛÛ "
=
ÛÛ# $
content
ÛÛ% ,
.
ÛÛ, -
Split
ÛÛ- 2
(
ÛÛ2 3

_delimiter
ÛÛ3 =
)
ÛÛ= >
;
ÛÛ> ?
for
ıı 
(
ıı 
int
ıı 
i
ıı 
=
ıı 
$num
ıı 
;
ıı 
i
ıı  !
<
ıı" #
	listItems
ıı$ -
.
ıı- .
Length
ıı. 4
-
ıı5 6
$num
ıı7 8
;
ıı8 9
i
ıı: ;
++
ıı; =
)
ıı= >
{
ˆˆ 
drp
˜˜ 
.
˜˜ 
Items
˜˜ 
.
˜˜ 
Add
˜˜ !
(
˜˜! "
new
˜˜" %
ListItem
˜˜& .
(
˜˜. /
	listItems
˜˜/ 8
[
˜˜8 9
i
˜˜9 :
]
˜˜: ;
,
˜˜; <
	listItems
˜˜= F
[
˜˜F G
i
˜˜G H
+
˜˜I J
$num
˜˜K L
]
˜˜L M
)
˜˜M N
)
˜˜N O
;
˜˜O P
i
¯¯ 
++
¯¯ 
;
¯¯ 
}
˘˘ 
ListItem
˚˚ 
selectedListItem
˚˚ )
=
˚˚* +
drp
˚˚, /
.
˚˚/ 0
Items
˚˚0 5
.
˚˚5 6
FindByValue
˚˚6 A
(
˚˚A B
selectedValue
˚˚B O
)
˚˚O P
;
˚˚P Q
if
¸¸ 
(
¸¸ 
selectedListItem
¸¸ $
!=
¸¸% '
null
¸¸( ,
)
¸¸, -
{
˝˝ 
selectedListItem
˛˛ $
.
˛˛$ %
Selected
˛˛% -
=
˛˛. /
true
˛˛0 4
;
˛˛4 5
}
ˇˇ 
}
ÄÄ 
}
ÅÅ 	
public
ââ 
static
ââ 
string
ââ 

EncodeTo64
ââ '
(
ââ' (
string
ââ( .
toEncode
ââ/ 7
)
ââ7 8
{
ää 	
byte
ãã 
[
ãã 
]
ãã 
toEncodeAsBytes
ãã "
=
ãã# $
System
ãã% +
.
ãã+ ,
Text
ãã, 0
.
ãã0 1
ASCIIEncoding
ãã1 >
.
ãã> ?
ASCII
ãã? D
.
ããD E
GetBytes
ããE M
(
ããM N
toEncode
ããN V
)
ããV W
;
ããW X
string
åå 
returnValue
åå 
=
åå  
System
åå! '
.
åå' (
Convert
åå( /
.
åå/ 0
ToBase64String
åå0 >
(
åå> ?
toEncodeAsBytes
åå? N
)
ååN O
;
ååO P
return
çç 
returnValue
çç 
;
çç 
}
éé 	
public
ññ 
static
ññ 
string
ññ 
DecodeFrom64
ññ )
(
ññ) *
string
ññ* 0
encodedData
ññ1 <
)
ññ< =
{
óó 	
byte
òò 
[
òò 
]
òò  
encodedDataAsBytes
òò %
=
òò& '
System
òò( .
.
òò. /
Convert
òò/ 6
.
òò6 7
FromBase64String
òò7 G
(
òòG H
encodedData
òòH S
)
òòS T
;
òòT U
string
ôô 
returnValue
ôô 
=
ôô  
System
ôô! '
.
ôô' (
Text
ôô( ,
.
ôô, -
ASCIIEncoding
ôô- :
.
ôô: ;
ASCII
ôô; @
.
ôô@ A
	GetString
ôôA J
(
ôôJ K 
encodedDataAsBytes
ôôK ]
)
ôô] ^
;
ôô^ _
return
öö 
returnValue
öö 
;
öö 
}
õõ 	
public
££ 
static
££ 
string
££ 
GetDisplayDate
££ +
(
££+ ,
string
££, 2
_displayDate
££3 ?
)
££? @
{
§§ 	
string
•• 
retVal
•• 
=
•• 
$str
•• 
;
•• 
TimeSpan
¶¶ 
tsDiff
¶¶ 
=
¶¶ 
DateTime
¶¶ &
.
¶¶& '
Now
¶¶' *
.
¶¶* +
Subtract
¶¶+ 3
(
¶¶3 4
Convert
¶¶4 ;
.
¶¶; <

ToDateTime
¶¶< F
(
¶¶F G
_displayDate
¶¶G S
)
¶¶S T
)
¶¶T U
;
¶¶U V
if
®® 
(
®® 
tsDiff
®® 
.
®® 
Days
®® 
>
®® 
$num
®® 
)
®®  
retVal
©© 
=
©© 
tsDiff
©© 
.
©©  
Days
©©  $
.
©©$ %
ToString
©©% -
(
©©- .
)
©©. /
+
©©0 1
$str
©©2 =
;
©©= >
else
™™ 
if
™™ 
(
™™ 
tsDiff
™™ 
.
™™ 
Hours
™™ !
>
™™" #
$num
™™$ %
)
™™% &
retVal
´´ 
=
´´ 
tsDiff
´´ 
.
´´  
Hours
´´  %
.
´´% &
ToString
´´& .
(
´´. /
)
´´/ 0
+
´´1 2
$str
´´3 ?
;
´´? @
else
¨¨ 
if
¨¨ 
(
¨¨ 
tsDiff
¨¨ 
.
¨¨ 
Minutes
¨¨ #
>
¨¨$ %
$num
¨¨& '
)
¨¨' (
retVal
≠≠ 
=
≠≠ 
tsDiff
≠≠ 
.
≠≠  
Minutes
≠≠  '
.
≠≠' (
ToString
≠≠( 0
(
≠≠0 1
)
≠≠1 2
+
≠≠3 4
$str
≠≠5 C
;
≠≠C D
else
ÆÆ 
if
ÆÆ 
(
ÆÆ 
tsDiff
ÆÆ 
.
ÆÆ 
Seconds
ÆÆ #
>
ÆÆ$ %
$num
ÆÆ& '
)
ÆÆ' (
retVal
ØØ 
=
ØØ 
tsDiff
ØØ 
.
ØØ  
Seconds
ØØ  '
.
ØØ' (
ToString
ØØ( 0
(
ØØ0 1
)
ØØ1 2
+
ØØ3 4
$str
ØØ5 C
;
ØØC D
if
±± 
(
±± 
tsDiff
±± 
.
±± 
Days
±± 
>
±± 
$num
±± !
)
±±! "
retVal
≤≤ 
=
≤≤ 
Convert
≤≤  
.
≤≤  !
ToString
≤≤! )
(
≤≤) *
tsDiff
≤≤* 0
.
≤≤0 1
Days
≤≤1 5
/
≤≤6 7
$num
≤≤8 ;
)
≤≤; <
+
≤≤= >
$str
≤≤? K
;
≤≤K L
else
≥≥ 
if
≥≥ 
(
≥≥ 
tsDiff
≥≥ 
.
≥≥ 
Days
≥≥  
>
≥≥! "
$num
≥≥# %
)
≥≥% &
retVal
¥¥ 
=
¥¥ 
Convert
¥¥  
.
¥¥  !
ToString
¥¥! )
(
¥¥) *
tsDiff
¥¥* 0
.
¥¥0 1
Days
¥¥1 5
/
¥¥6 7
$num
¥¥8 :
)
¥¥: ;
+
¥¥< =
$str
¥¥> K
;
¥¥K L
return
∂∂ 
retVal
∂∂ 
;
∂∂ 
}
∑∑ 	
public
ææ 
static
ææ 
void
ææ 
RedirectPermanent
ææ ,
(
ææ, -
string
ææ- 3
newPath
ææ4 ;
)
ææ; <
{
øø 	
HttpContext
¿¿ 
.
¿¿ 
Current
¿¿ 
.
¿¿  
Response
¿¿  (
.
¿¿( )
Clear
¿¿) .
(
¿¿. /
)
¿¿/ 0
;
¿¿0 1
HttpContext
¡¡ 
.
¡¡ 
Current
¡¡ 
.
¡¡  
Response
¡¡  (
.
¡¡( )

StatusCode
¡¡) 3
=
¡¡4 5
$num
¡¡6 9
;
¡¡9 :
HttpContext
¬¬ 
.
¬¬ 
Current
¬¬ 
.
¬¬  
Response
¬¬  (
.
¬¬( )
	AddHeader
¬¬) 2
(
¬¬2 3
$str
¬¬3 =
,
¬¬= >
newPath
¬¬? F
)
¬¬F G
;
¬¬G H
HttpContext
√√ 
.
√√ 
Current
√√ 
.
√√  
Response
√√  (
.
√√( )
End
√√) ,
(
√√, -
)
√√- .
;
√√. /
}
ƒƒ 	
public
ÀÀ 
static
ÀÀ 
string
ÀÀ #
GetContentTypesString
ÀÀ 2
<
ÀÀ2 3
T
ÀÀ3 4
>
ÀÀ4 5
(
ÀÀ5 6
List
ÀÀ6 :
<
ÀÀ: ;
T
ÀÀ; <
>
ÀÀ< =
contentList
ÀÀ> I
)
ÀÀI J
{
ÃÃ 	
string
ŒŒ 
_contentTypes
ŒŒ  
=
ŒŒ! "
string
ŒŒ# )
.
ŒŒ) *
Empty
ŒŒ* /
;
ŒŒ/ 0
ushort
œœ 
_contentType
œœ 
=
œœ  !
$num
œœ" #
;
œœ# $
foreach
—— 
(
—— 
var
—— 
item
—— 
in
——  
contentList
——! ,
)
——, -
{
““ 
_contentType
”” 
=
”” 
Convert
”” &
.
””& '
ToUInt16
””' /
(
””/ 0
item
””0 4
)
””4 5
;
””5 6
_contentTypes
‘‘ 
+=
‘‘  
_contentType
‘‘! -
.
‘‘- .
ToString
‘‘. 6
(
‘‘6 7
)
‘‘7 8
+
‘‘9 :
$char
‘‘; >
;
‘‘> ?
}
’’ 
_contentTypes
◊◊ 
=
◊◊ 
_contentTypes
◊◊ )
.
◊◊) *
Remove
◊◊* 0
(
◊◊0 1
_contentTypes
◊◊1 >
.
◊◊> ?
LastIndexOf
◊◊? J
(
◊◊J K
$char
◊◊K N
)
◊◊N O
)
◊◊O P
;
◊◊P Q
return
ŸŸ 
_contentTypes
ŸŸ  
;
ŸŸ  !
}
€€ 	
public
„„ 
static
„„ 
DateTime
„„ 
GetValidDate
„„ +
(
„„+ ,
int
„„, /
noOfDays
„„0 8
)
„„8 9
{
‰‰ 	
DateTime
ÂÂ 
dt
ÂÂ 
=
ÂÂ 
DateTime
ÂÂ "
.
ÂÂ" #
Now
ÂÂ# &
.
ÂÂ& '
AddDays
ÂÂ' .
(
ÂÂ. /
noOfDays
ÂÂ/ 7
)
ÂÂ7 8
;
ÂÂ8 9
return
ÊÊ 
dt
ÊÊ 
;
ÊÊ 
}
ÁÁ 	
}
ÈÈ 
}ÍÍ à

:D:\work\bikewaleweb\Bikewale.DAL.CoreDAL\DatabaseHelper.cs
	namespace

 	
Bikewale


 
.

 
DAL

 
.

 
CoreDAL

 
{ 
public 

static 
class 
DatabaseHelper &
{ 
public 
static 
IDbConnection #!
GetReadonlyConnection$ 9
(9 :
): ;
{ 	
IDbConnection 
conn 
=  
new! $
MySqlConnection% 4
(4 5 
ConfigurationManager5 I
.I J
AppSettingsJ U
[U V
$strV p
]p q
)q r
;r s
return 
conn 
; 
} 	
public!! 
static!! 
IDbConnection!! #
GetMasterConnection!!$ 7
(!!7 8
)!!8 9
{"" 	
IDbConnection## 
conn## 
=##  
new##! $
MySqlConnection##% 4
(##4 5 
ConfigurationManager##5 I
.##I J
AppSettings##J U
[##U V
$str##V n
]##n o
)##o p
;##p q
return%% 
conn%% 
;%% 
}&& 	
}'' 
}(( —
AD:\work\bikewaleweb\Bikewale.DAL.CoreDAL\ElasticSearchInstance.cs
	namespace		 	
Bikewale		
 
.		 
DAL		 
.		 
CoreDAL		 
{

 
public 

sealed 
class !
ElasticSearchInstance -
{ 
private 
static 
readonly !
ElasticSearchInstance  5
_clientInstance6 E
=F G
newH K!
ElasticSearchInstanceL a
(a b
)b c
;c d
private 
ElasticClient 
_client %
;% &
static !
ElasticSearchInstance $
($ %
)% &
{ 	
} 	
public 
static 
ElasticClient #
GetInstance$ /
(/ 0
)0 1
{2 3
return 
_clientInstance "
." #
_client# *
;* +
} 	
private !
ElasticSearchInstance %
(% &
)& '
{ 	
try 
{ 
Uri 
[ 
] 
nodes 
=  
ConfigurationManager 2
.2 3
AppSettings3 >
[> ?
$str? O
]O P
.P Q
SplitQ V
(V W
$charW Z
)Z [
.  - .
Select  . 4
(  4 5
s  5 6
=>  7 9
new  : =
Uri  > A
(  A B
$str  B K
+  L M
s  N O
)  O P
)  P Q
.  Q R
ToArray  R Y
(  Y Z
)  Z [
;  [ \
var!! 
connectionPool!! "
=!!# $
new!!% ("
SniffingConnectionPool!!) ?
(!!? @
nodes!!@ E
)!!E F
;!!F G
var"" 
settings"" 
="" 
new"" "
ConnectionSettings""# 5
(""5 6
connectionPool## "
)$$ 
.$$ 
MaximumRetries$$  
($$  !
$num$$! "
)$$" #
.%% "
DisableDirectStreaming%% '
(%%' (
)%%( )
.&& "
SniffOnConnectionFault&& (
(&&( )
true&&) -
)&&- .
.'' 
SniffOnStartup''  
(''  !
true''! %
)''% &
.(( 
SniffLifeSpan(( 
(((  
TimeSpan((  (
.((( )
FromMinutes(() 4
(((4 5
$num((5 6
)((6 7
)((7 8
;((8 9
_client** 
=** 
new** 
ElasticClient** +
(**+ ,
settings**, 4
)**4 5
;**5 6
},, 
catch-- 
(-- 
	Exception-- 
ex-- 
)--  
{.. 
var// 
objErr// 
=// 
new//  

ErrorClass//! +
(//+ ,
ex//, .
,//. /
$str//0 _
+//` a
ex//b d
.//d e
InnerException//e s
)//s t
;//t u
objErr00 
.00 
SendMail00 
(00  
)00  !
;00! "
}11 
}33 	
}44 
}55 Ó
CD:\work\bikewaleweb\Bikewale.DAL.CoreDAL\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str /
)/ 0
]0 1
[		 
assembly		 	
:			 

AssemblyDescription		 
(		 
$str		 !
)		! "
]		" #
[

 
assembly

 	
:

	 
!
AssemblyConfiguration

  
(

  !
$str

! #
)

# $
]

$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str 
) 
] 
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str 1
)1 2
]2 3
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
[## 
assembly## 	
:##	 

AssemblyVersion## 
(## 
$str## $
)##$ %
]##% &
[$$ 
assembly$$ 	
:$$	 

AssemblyFileVersion$$ 
($$ 
$str$$ (
)$$( )
]$$) *