◊
6D:\work\bikewaleweb\BikeWale.Sitemap\UsedBikeEntity.cs
	namespace 	
BikeWale
 
. 
Sitemap 
{ 
public		 

class		 
UsedBikeEntity		 
{

 
public 
string 
MakeName 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
	ModelName 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
CityName 
{  
get! $
;$ %
set& )
;) *
}+ ,
} 
} ∏c
7D:\work\bikewaleweb\BikeWale.Sitemap\UsedBikeSiteMap.cs
	namespace

 	
BikeWale


 
.

 
Sitemap

 
{ 
public 

class 
UsedBikeSiteMap  
{ 
public 
void 
GenerateSiteMap #
(# $
)$ %
{ 	
string 
domain 
=  
ConfigurationManager 0
.0 1
AppSettings1 <
[< =
$str= P
]P Q
;Q R
string 
usedSitemapLoc !
=" # 
ConfigurationManager$ 8
.8 9
AppSettings9 D
[D E
$strE U
]U V
;V W
IEnumerable 
< 
UsedBikeEntity &
>& '
SitemapList( 3
=4 5
null6 :
;: ;
if 
( 
domain 
!= 
null 
) 
try 
{ "
UsedBikeUrlsRepository &
urlObj' -
=. /
new0 3"
UsedBikeUrlsRepository4 J
(J K
)K L
;L M
SitemapList   
=   
urlObj   "
.  " #
GetUsedBikeUrls  # 2
(  2 3
)  3 4
;  4 5
if## 
(## 
usedSitemapLoc## #
!=##$ &
null##' +
)##+ ,
{$$ 
System%% 
.%% 
IO%% 
.%% 
	Directory%% '
.%%' (
CreateDirectory%%( 7
(%%7 8
usedSitemapLoc%%8 F
)%%F G
;%%G H
IEnumerable(( 
<((  
string((  &
>((& '
urlList((( /
=((0 1
CreateUsedBikeUrls((2 D
(((D E
SitemapList((E P
)((P Q
;((Q R
XmlWriterSettings** %
settings**& .
=**/ 0
new**1 4
XmlWriterSettings**5 F
(**F G
)**G H
;**H I
settings++ 
.++ 
Indent++ #
=++$ %
true++& *
;++* +
using.. 
(.. 
	XmlWriter.. $
writer..% +
=.., -
	XmlWriter... 7
...7 8
Create..8 >
(..> ?
string..? E
...E F
Format..F L
(..L M
$str..M `
,..` a
usedSitemapLoc..b p
)..p q
,..q r
settings..s {
)..{ |
)..| }
{// 
writer00 
.00 
WriteStartDocument00 1
(001 2
)002 3
;003 4
writer11 
.11 
WriteStartElement11 0
(110 1
$str111 9
,119 :
$str11; h
)11h i
;11i j
if33 
(33 
urlList33 #
!=33$ &
null33' +
&&33, .
urlList33/ 6
.336 7
Count337 <
(33< =
)33= >
>33? @
$num33A B
)33B C
{44 
foreach55 #
(55$ %
var55% (
url55) ,
in55- /
urlList550 7
)557 8
{66 
writer77  &
.77& '
WriteStartElement77' 8
(778 9
$str779 >
)77> ?
;77? @
writer88  &
.88& '
WriteElementString88' 9
(889 :
$str88: ?
,88? @
String88A G
.88G H
Format88H N
(88N O
$str88O W
,88W X
domain88Y _
,88_ `
url88a d
)88d e
)88e f
;88f g
writer99  &
.99& '
WriteEndElement99' 6
(996 7
)997 8
;998 9
}:: 
};; 
writer<< 
.<< 
WriteEndDocument<< /
(<</ 0
)<<0 1
;<<1 2
writer== 
.== 
Flush== $
(==$ %
)==% &
;==& '
writer>> 
.>> 
Close>> $
(>>$ %
)>>% &
;>>& '
}?? 
}@@ 
}BB 
catchCC 
(CC 
	ExceptionCC 
exCC 
)CC  
{DD 
LogsEE 
.EE 
WriteErrorLogEE "
(EE" #
$strEE# @
+EEA B
exEEC E
.EEE F
MessageEEF M
)EEM N
;EEN O
}FF 
}GG 	
publicNN 
IEnumerableNN 
<NN 
stringNN !
>NN! "
CreateUsedBikeUrlsNN# 5
(NN5 6
IEnumerableNN6 A
<NNA B
UsedBikeEntityNNB P
>NNP Q
SitemapListNNR ]
)NN] ^
{OO 	
IListPP 
<PP 
stringPP 
>PP 
urlListPP !
=PP" #
newPP$ '
ListPP( ,
<PP, -
stringPP- 3
>PP3 4
(PP4 5
)PP5 6
;PP6 7
tryQQ 
{RR 
StringBuilderSS 
UrlSS !
=SS" #
nullSS$ (
;SS( )
urlListTT 
.TT 
AddTT 
(TT 
$strTT -
)TT- .
;TT. /
varWW 
citiesWW 
=WW 
(WW 
fromWW #
cityWW$ (
inWW) +
SitemapListWW, 7
selectXX $
cityXX% )
.XX) *
CityNameXX* 2
)XX2 3
.XX3 4
DistinctXX4 <
(XX< =
)XX= >
;XX> ?
ifZZ 
(ZZ 
citiesZZ 
!=ZZ 
nullZZ 
)ZZ  
foreach[[ 
([[ 
var[[ 
city[[  
in[[! #
cities[[$ *
)[[* +
{\\ 
Url]] 
=]] 
new]] 
StringBuilder]] +
(]]+ ,
)]], -
;]]- .
Url^^ 
.^^ 
Append^^ 
(^^ 
String^^ %
.^^% &
Format^^& ,
(^^, -
$str^^- <
,^^< =
city^^= A
)^^A B
)^^B C
;^^C D
urlList__ 
.__ 
Add__ 
(__  
Url__  #
.__# $
ToString__$ ,
(__, -
)__- .
)__. /
;__/ 0
}`` 
varcc 
makescc 
=cc 
(cc 
fromcc !
makecc" &
incc' )
SitemapListcc* 5
selectdd #
makedd$ (
.dd( )
MakeNamedd) 1
)dd1 2
.dd2 3
Distinctdd3 ;
(dd; <
)dd< =
;dd= >
ifff 
(ff 
makesff 
!=ff 
nullff !
)ff! "
foreachgg 
(gg 
vargg 
makegg  
ingg! #
makesgg$ )
)gg) *
{hh 
Urlii 
=ii 
newii 
StringBuilderii +
(ii+ ,
)ii, -
;ii- .
Urljj 
.jj 
Appendjj 
(jj 
Stringjj %
.jj% &
Formatjj& ,
(jj, -
$strjj- B
,jjB C
makejjC G
)jjG H
)jjH I
;jjI J
urlListkk 
.kk 
Addkk 
(kk  
Urlkk  #
.kk# $
ToStringkk$ ,
(kk, -
)kk- .
)kk. /
;kk/ 0
}ll 
varoo 
makecityoo 
=oo 
(oo 
fromoo #
makeoo$ (
inoo) +
SitemapListoo, 7
.oo7 8
GroupByoo8 ?
(oo? @
itemoo@ D
=>ooE G
newooH K
{ooL M
itemooN R
.ooR S
MakeNameooS [
,oo[ \
itemoo] a
.ooa b
CityNameoob j
}ook l
)ool m
.oom n
Selectoon t
(oot u
grpoou x
=>ooy {
grpoo| 
.	oo Ä
Key
ooÄ É
)
ooÉ Ñ
selectpp  &
newpp' *
UsedBikeEntitypp+ 9
(pp9 :
)pp: ;
{pp< =
MakeNamepp> F
=ppG H
makeppI M
.ppM N
MakeNameppN V
,ppV W
CityNameppX `
=ppa b
makeppc g
.ppg h
CityNamepph p
}ppq r
)ppr s
;pps t
ifrr 
(rr 
makecityrr 
!=rr 
nullrr  $
)rr$ %
foreachss 
(ss 
varss 
itemss !
inss" $
makecityss% -
)ss- .
{tt 
Urluu 
=uu 
newuu 
StringBuilderuu +
(uu+ ,
)uu, -
;uu- .
Urlvv 
.vv 
Appendvv 
(vv 
Stringvv %
.vv% &
Formatvv& ,
(vv, -
$strvv- @
,vv@ A
itemvvB F
.vvF G
MakeNamevvG O
,vvO P
itemvvP T
.vvT U
CityNamevvU ]
)vv] ^
)vv^ _
;vv_ `
urlListww 
.ww 
Addww 
(ww  
Urlww  #
.ww# $
ToStringww$ ,
(ww, -
)ww- .
)ww. /
;ww/ 0
}xx 
var{{ 

makemodels{{ 
={{  
({{! "
from{{" &
model{{' ,
in{{- /
SitemapList{{0 ;
.{{; <
GroupBy{{< C
({{C D
item{{D H
=>{{I K
new{{L O
{{{P Q
item{{R V
.{{V W
MakeName{{W _
,{{_ `
item{{a e
.{{e f
	ModelName{{f o
}{{p q
){{q r
.{{r s
Select{{s y
({{y z
grp{{z }
=>	{{~ Ä
grp
{{Å Ñ
.
{{Ñ Ö
Key
{{Ö à
)
{{à â
select||" (
new||) ,
UsedBikeEntity||- ;
(||; <
)||< =
{||> ?
MakeName||@ H
=||I J
model||K P
.||P Q
MakeName||Q Y
,||Y Z
	ModelName||[ d
=||e f
model||g l
.||l m
	ModelName||m v
}||w x
)||x y
;||y z
if~~ 
(~~ 

makemodels~~ 
!=~~ 
null~~ #
)~~# $
foreach 
( 
var 
item !
in" $

makemodels% /
)/ 0
{
ÄÄ 
Url
ÅÅ 
=
ÅÅ 
new
ÅÅ 
StringBuilder
ÅÅ +
(
ÅÅ+ ,
)
ÅÅ, -
;
ÅÅ- .
Url
ÇÇ 
.
ÇÇ 
Append
ÇÇ 
(
ÇÇ 
String
ÇÇ %
.
ÇÇ% &
Format
ÇÇ& ,
(
ÇÇ, -
$str
ÇÇ- F
,
ÇÇF G
item
ÇÇH L
.
ÇÇL M
MakeName
ÇÇM U
,
ÇÇU V
item
ÇÇW [
.
ÇÇ[ \
	ModelName
ÇÇ\ e
)
ÇÇe f
)
ÇÇf g
;
ÇÇg h
urlList
ÉÉ 
.
ÉÉ 
Add
ÉÉ 
(
ÉÉ  
Url
ÉÉ  #
.
ÉÉ# $
ToString
ÉÉ$ ,
(
ÉÉ, -
)
ÉÉ- .
)
ÉÉ. /
;
ÉÉ/ 0
}
ÑÑ 
if
àà 
(
àà 
SitemapList
àà 
!=
àà  "
null
àà# '
)
àà' (
foreach
ââ 
(
ââ 
var
ââ 
item
ââ !
in
ââ" $
SitemapList
ââ% 0
)
ââ0 1
{
ää 
Url
ãã 
=
ãã 
new
ãã 
StringBuilder
ãã +
(
ãã+ ,
)
ãã, -
;
ãã- .
Url
åå 
.
åå 
Append
åå 
(
åå 
String
åå %
.
åå% &
Format
åå& ,
(
åå, -
$str
åå- D
,
ååD E
item
ååF J
.
ååJ K
MakeName
ååK S
,
ååS T
item
ååU Y
.
ååY Z
	ModelName
ååZ c
,
ååc d
item
ååd h
.
ååh i
CityName
ååi q
)
ååq r
)
åår s
;
åås t
urlList
çç 
.
çç 
Add
çç 
(
çç  
Url
çç  #
.
çç# $
ToString
çç$ ,
(
çç, -
)
çç- .
)
çç. /
;
çç/ 0
}
éé 
}
èè 
catch
êê 
(
êê 
	Exception
êê 
ex
êê 
)
êê  
{
ëë 
Logs
íí 
.
íí 
WriteErrorLog
íí "
(
íí" #
$str
íí# C
+
ííD E
ex
ííF H
.
ííH I
Message
ííI P
)
ííP Q
;
ííQ R
}
ìì 
return
ïï 
urlList
ïï 
;
ïï 
}
ññ 	
}
óó 
}òò …
?D:\work\bikewaleweb\BikeWale.Sitemap\UsedBikeUrlsRepository .cs
	namespace 	
BikeWale
 
. 
Sitemap 
{ 
public 

class "
UsedBikeUrlsRepository '
{ 
public 
IEnumerable 
< 
UsedBikeEntity )
>) *
GetUsedBikeUrls+ :
(: ;
); <
{ 	
IList 
< 
UsedBikeEntity  
>  !
SitemapList" -
=. /
null0 4
;4 5
try 
{ 
using   
(   
	DbCommand    
cmd  ! $
=  % &
	DbFactory  ' 0
.  0 1
GetDBCommand  1 =
(  = >
$str  > R
)  R S
)  S T
{!! 
cmd"" 
."" 
CommandType"" #
=""$ %
CommandType""& 1
.""1 2
StoredProcedure""2 A
;""A B
using$$ 
($$ 
IDataReader$$ '
dr$$( *
=$$+ ,
MySqlDatabase$$- :
.$$: ;
SelectQuery$$; F
($$F G
cmd$$G J
,$$J K
ConnectionType$$L Z
.$$Z [
MasterDatabase$$[ i
)$$i j
)$$j k
{%% 
if&& 
(&& 
dr&& 
!=&& !
null&&" &
)&&& '
{'' 
SitemapList(( '
=((( )
new((* -
List((. 2
<((2 3
UsedBikeEntity((3 A
>((A B
(((B C
)((C D
;((D E
while** !
(**" #
dr**# %
.**% &
Read**& *
(*** +
)**+ ,
)**, -
{++ 
SitemapList,,  +
.,,+ ,
Add,,, /
(,,/ 0
new,,0 3
UsedBikeEntity,,4 B
{--  !
MakeName..$ ,
=.., -
dr..- /
[../ 0
$str..0 A
]..A B
...B C
ToString..C K
(..K L
)..L M
,..M N
	ModelName//$ -
=//. /
dr//0 2
[//2 3
$str//3 E
]//E F
.//F G
ToString//G O
(//O P
)//P Q
,//Q R
CityName00$ ,
=00- .
dr00/ 1
[001 2
$str002 C
]00C D
.00D E
ToString00E M
(00M N
)00N O
,00O P
}11  !
)11! "
;11" #
}33 
dr44 
.44 
Close44 #
(44# $
)44$ %
;44% &
}55 
}66 
}77 
}88 
catch99 
(99 
	Exception99 
ex99 
)99  
{:: 
Logs;; 
.;; 
WriteErrorLog;; "
(;;" #
$str;;# 6
+;;7 8
ex;;9 ;
);;; <
;;;< =
}<< 
return== 
SitemapList== 
;== 
}>> 	
}?? 
}@@ Ö
/D:\work\bikewaleweb\BikeWale.Sitemap\Program.cs
	namespace 	
BikeWale
 
. 
Sitemap 
{		 
class

 	
Program


 
{ 
static 
void 
Main 
( 
string 
[  
]  !
args" &
)& '
{ 	
UsedBikeSiteMap 
siteMap #
=$ %
new& )
UsedBikeSiteMap* 9
(9 :
): ;
;; <
try 
{ 
siteMap 
. 
GenerateSiteMap '
(' (
)( )
;) *
} 
catch 
( 
	Exception 
ex 
)  
{ 
Logs 
. 
WriteErrorLog "
(" #
$str# /
+0 1
ex2 4
.4 5
Message5 <
)< =
;= >
} 
} 	
} 
} Í
?D:\work\bikewaleweb\BikeWale.Sitemap\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str +
)+ ,
], -
[		 
assembly		 	
:			 

AssemblyDescription		 
(		 
$str		 !
)		! "
]		" #
[

 
assembly

 	
:

	 
!
AssemblyConfiguration

  
(

  !
$str

! #
)

# $
]

$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str 
) 
] 
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str -
)- .
]. /
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
[## 
assembly## 	
:##	 

AssemblyVersion## 
(## 
$str## $
)##$ %
]##% &
[$$ 
assembly$$ 	
:$$	 

AssemblyFileVersion$$ 
($$ 
$str$$ (
)$$( )
]$$) *