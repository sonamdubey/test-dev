é
DD:\work\bikewaleweb\Bikewale.ReleaseManagement\copyfiles\Features.cs
	namespace 	
HtmlMinifier
 
{ 
public 

class 
Features 
{ 
public 
Features 
( 
string 
[ 
]  
args! %
)% &
{ 	
int 
	maxLength 
= 
$num 
; 
if 
( 
args 
!= 
null 
&& 
args  $
.$ %
Length% +
>, -
$num. /
)/ 0
{ 
if 
( 
args 
. 
Contains !
(! "
$str" 6
)6 7
)7 8
{ 
IgnoreHtmlComments &
=' (
true) -
;- .
} 
if 
( 
args 
. 
Contains !
(! "
$str" 4
)4 5
)5 6
{ 
IgnoreJsComments $
=% &
true' +
;+ ,
} 
int 
. 
TryParse 
( 
args !
[! "
$num" #
]# $
,$ %
out& )
	maxLength* 3
)3 4
;4 5
} 
	MaxLength!! 
=!! 
	maxLength!! !
;!!! "
}"" 	
public'' 
bool'' 
IgnoreJsComments'' $
{''% &
get''' *
;''* +
private'', 3
set''4 7
;''7 8
}''9 :
public,, 
bool,, 
IgnoreHtmlComments,, &
{,,' (
get,,) ,
;,,, -
private,,. 5
set,,6 9
;,,9 :
},,; <
public11 
bool11 "
IgnoreKnockoutComments11 *
{11+ ,
get11- 0
{111 2
return113 9
true11: >
;11> ?
}11@ A
}11B C
public66 
int66 
	MaxLength66 
{66 
get66 "
;66" #
private66$ +
set66, /
;66/ 0
}661 2
}77 
}88 ¸†
CD:\work\bikewaleweb\Bikewale.ReleaseManagement\copyfiles\Program.cs
	namespace

 	
	CopyFiles


 
{ 
class 	
Program
 
{ 
static 
string 
[ 
] 
ignoreFiles #
=$ % 
ConfigurationManager& :
.: ;
AppSettings; F
[F G
$strG T
]T U
.U V
ToStringV ^
(^ _
)_ `
.` a
Splita f
(f g
$charg j
)j k
;k l
static 
string 
[ 
] 
ignoreFolders %
=& ' 
ConfigurationManager( <
.< =
AppSettings= H
[H I
$strI X
]X Y
.Y Z
ToStringZ b
(b c
)c d
.d e
Splite j
(j k
$chark n
)n o
;o p
static 
bool 
buildSolution !
=" #
Convert$ +
.+ ,
	ToBoolean, 5
(5 6 
ConfigurationManager6 J
.J K
AppSettingsK V
[V W
$strW f
]f g
.g h
ToStringh p
(p q
)q r
)r s
;s t
static 
void 
Main 
( 
string 
[  
]  !
args" &
)& '
{ 	
bool 
isMinify 
= 
false !
;! "
string 
path 
= 
string  
.  !
Empty! &
,& '
copyPath( 0
=1 2
string3 9
.9 :
Empty: ?
,? @

sourcePathA K
=L M
stringN T
.T U
EmptyU Z
;Z [
DateTime!! 
fromDateTime!! !
=!!" #
DateTime!!$ ,
.!!, -
Now!!- 0
.!!0 1
AddDays!!1 8
(!!8 9
-!!9 :
$num!!: ;
)!!; <
;!!< =
if## 
(## 
args## 
!=## 
null## 
&&## 
args##  $
.##$ %
Length##% +
>##, -
$num##. /
)##/ 0
{$$ 
fromDateTime%% 
=%% 
DateTime%% '
.%%' (
Now%%( +
.%%+ ,
AddDays%%, 3
(%%3 4
-%%4 5
Convert%%5 <
.%%< =
ToSByte%%= D
(%%D E
args%%E I
[%%I J
$num%%J K
]%%K L
)%%L M
)%%M N
;%%N O
if'' 
('' 
args'' 
.'' 
Length'' 
>''  !
$num''" #
)''# $
{(( 
path)) 
=)) 
args)) 
[))  
$num))  !
]))! "
;))" #
path** 
=** 
path** 
.**  
Trim**  $
(**$ %
)**% &
;**& '
if,, 
(,, 
!,, 
String,, 
.,,  
IsNullOrEmpty,,  -
(,,- .
path,,. 2
),,2 3
),,3 4
{-- 
isMinify..  
=..! "
!..# $
path..$ (
...( )
ToUpper..) 0
(..0 1
)..1 2
...2 3
Contains..3 ;
(..; <
$str..< A
)..A B
;..B C
copyPath//  
=//! "
String//# )
.//) *
Format//* 0
(//0 1
$str//1 b
,//b c
path//d h
,//h i
isMinify//j r
?//s t
string//u {
.//{ |
Empty	//| 
:
//‚ ƒ
$str
//„ ‰
)
//‰ Š
;
//Š ‹
}00 
}11 
}22 
CopyAllFiles55 
(55 
path55 
,55 
copyPath55 '
,55' (
fromDateTime55) 5
,555 6
isMinify557 ?
)55? @
;55@ A

sourcePath77 
=77 
String77 
.77  
Format77  &
(77& '
$str77' 3
,773 4
copyPath775 =
)77= >
;77> ?#
MoveBuildFolderContents88 #
(88# $
copyPath88$ ,
,88, -

sourcePath88. 8
)888 9
;889 :

sourcePath:: 
=:: 
String:: 
.::  
Format::  &
(::& '
$str::' 3
,::3 4
copyPath::5 =
.::= >
Replace::> E
(::E F
$str::F R
,::R S
$str::T \
)::\ ]
)::] ^
;::^ _#
MoveBuildFolderContents;; #
(;;# $
string;;$ *
.;;* +
Format;;+ 1
(;;1 2
$str;;2 ?
,;;? @
copyPath;;A I
);;I J
,;;J K

sourcePath;;L V
);;V W
;;;W X
}<< 	
privateCC 
staticCC 
voidCC #
MoveBuildFolderContentsCC 3
(CC3 4
stringCC4 :

targetPathCC; E
,CCE F
stringCCG M

sourcePathCCN X
)CCX Y
{DD 	
ifFF 
(FF 
!FF 
	DirectoryFF 
.FF 
ExistsFF !
(FF! "

targetPathFF" ,
)FF, -
)FF- .
{GG 
	DirectoryHH 
.HH 
CreateDirectoryHH )
(HH) *

targetPathHH* 4
)HH4 5
;HH5 6
}II 
ifKK 
(KK 
SystemKK 
.KK 
IOKK 
.KK 
	DirectoryKK #
.KK# $
ExistsKK$ *
(KK* +

targetPathKK+ 5
)KK5 6
)KK6 7
{LL 
stringMM 
[MM 
]MM 
filesMM 
=MM  
SystemMM! '
.MM' (
IOMM( *
.MM* +
	DirectoryMM+ 4
.MM4 5
GetFilesMM5 =
(MM= >

sourcePathMM> H
)MMH I
;MMI J
foreachNN 
(NN 
stringNN 
sNN  !
inNN" $
filesNN% *
)NN* +
{OO 
SystemPP 
.PP 
IOPP 
.PP 
FilePP "
.PP" #
CopyPP# '
(PP' (
sPP( )
,PP) *
SystemPP+ 1
.PP1 2
IOPP2 4
.PP4 5
PathPP5 9
.PP9 :
CombinePP: A
(PPA B

targetPathPPB L
,PPL M
SystemPPN T
.PPT U
IOPPU W
.PPW X
PathPPX \
.PP\ ]
GetFileNamePP] h
(PPh i
sPPi j
)PPj k
)PPk l
,PPl m
truePPn r
)PPr s
;PPs t
}QQ 
foreachTT 
(TT 
stringTT 
directoriesTT  +
inTT, .
	DirectoryTT/ 8
.TT8 9
GetDirectoriesTT9 G
(TTG H

sourcePathTTH R
)TTR S
)TTS T
{UU 
stringVV 

folderNameVV %
=VV& '
directoriesVV( 3
.VV3 4
ReplaceVV4 ;
(VV; <

sourcePathVV< F
,VVF G
$strVVH J
)VVJ K
;VVK L
stringWW 
newCopyPathWW &
=WW' (

targetPathWW) 3
+WW4 5

folderNameWW6 @
;WW@ A
ifYY 
(YY 
ConvertYY 
.YY  
ToInt32YY  '
(YY' (
ArrayYY( -
.YY- .
IndexOfYY. 5
(YY5 6
ignoreFoldersYY6 C
,YYC D

folderNameYYE O
)YYO P
)YYP Q
<YYR S
$numYYT U
)YYU V
{ZZ 
newCopyPath[[ #
=[[$ %
newCopyPath[[& 1
+[[2 3
$str[[4 8
;[[8 9#
MoveBuildFolderContents\\ /
(\\/ 0
newCopyPath\\0 ;
,\\; <
directories\\= H
)\\H I
;\\I J
}]] 
}^^ 
	Directory`` 
.`` 
Delete``  
(``  !

sourcePath``! +
,``+ ,
true``- 1
)``1 2
;``2 3
}bb 
elsecc 
{dd 
Consoleee 
.ee 
	WriteLineee !
(ee! "
$stree" ?
)ee? @
;ee@ A
}ff 
}gg 	
publicqq 
staticqq 
stringqq 

MinifyHtmlqq '
(qq' (
stringqq( .
filePathqq/ 7
,qq7 8
Featuresqq9 A
featuresqqB J
)qqJ K
{rr 	
usingss 
(ss 
varss 
readerss 
=ss 
newss  #
StreamReaderss$ 0
(ss0 1
filePathss1 9
)ss9 :
)ss: ;
{tt 
returnuu 
readeruu 
.uu 
MinifyHtmlCodeuu ,
(uu, -
featuresuu- 5
)uu5 6
;uu6 7
}vv 
}ww 	
public
„„ 
static
„„ 
void
„„ 
CopyAllFiles
„„ '
(
„„' (
string
„„( .
path
„„/ 3
,
„„3 4
string
„„5 ;

targetPath
„„< F
,
„„F G
DateTime
„„H P
fromDateTime
„„Q ]
,
„„] ^
bool
„„_ c
isMinify
„„d l
)
„„l m
{
…… 	
var
†† 
features
†† 
=
†† 
new
†† 
Features
†† '
(
††' (
null
††( ,
)
††, -
;
††- .
path
ˆˆ 
.
ˆˆ 
Replace
ˆˆ 
(
ˆˆ 
$str
ˆˆ 
,
ˆˆ 
$str
ˆˆ  $
)
ˆˆ$ %
;
ˆˆ% &

targetPath
‰‰ 
.
‰‰ 
Replace
‰‰ 
(
‰‰ 
$str
‰‰ $
,
‰‰$ %
$str
‰‰& *
)
‰‰* +
;
‰‰+ ,
foreach
‹‹ 
(
‹‹ 
string
‹‹ 
fileName
‹‹ $
in
‹‹% '
	Directory
‹‹( 1
.
‹‹1 2
GetFiles
‹‹2 :
(
‹‹: ;
path
‹‹; ?
)
‹‹? @
)
‹‹@ A
{
ŒŒ 
string
 
fileExtension
 $
=
% &
Path
' +
.
+ ,
GetExtension
, 8
(
8 9
fileName
9 A
)
A B
;
B C
DateTime
’’ 
lastModifiedDate
’’ )
=
’’* +
File
’’, 0
.
’’0 1
GetLastWriteTime
’’1 A
(
’’A B
fileName
’’B J
)
’’J K
;
’’K L
if
•• 
(
•• 
!
•• 
string
•• 
.
•• 
IsNullOrEmpty
•• )
(
••) *
fileExtension
••* 7
)
••7 8
&&
••9 ;
Convert
••< C
.
••C D
ToInt32
••D K
(
••K L
Array
••L Q
.
••Q R
IndexOf
••R Y
(
••Y Z
ignoreFiles
••Z e
,
••e f
fileExtension
••g t
)
••t u
)
••u v
<
••w x
$num
••y z
)••¢ £
{
–– 
if
˜˜ 
(
˜˜ 
!
˜˜ 
	Directory
˜˜ "
.
˜˜" #
Exists
˜˜# )
(
˜˜) *

targetPath
˜˜* 4
)
˜˜4 5
)
˜˜5 6
{
™™ 
	Directory
šš !
.
šš! "
CreateDirectory
šš" 1
(
šš1 2

targetPath
šš2 <
)
šš< =
;
šš= >
}
›› 
if
žž 
(
žž 
(
žž 
!
žž 
fileExtension
žž (
.
žž( )
Equals
žž) /
(
žž/ 0
$str
žž0 9
)
žž9 :
&&
žž; =
!
žž> ?
fileExtension
žž? L
.
žžL M
Equals
žžM S
(
žžS T
$str
žžT Z
)
žžZ [
)
žž[ \
||
žž] _
(
žž` a
Path
žžb f
.
žžf g
GetFileName
žžg r
(
žžr s
fileName
žžs {
)
žž{ |
.
žž| }
Equalsžž} ƒ
(žžƒ „
$stržž„ 
)žž ‘
||žž’ ”
Pathžž• ™
.žž™ š
GetFileNamežžš ¥
(žž¥ ¦
fileNamežž¦ ®
)žž® ¯
.žž¯ °
Equalsžž° ¶
(žž¶ ·
$stržž· Ì
)žžÌ Í
||žžÎ Ð
PathžžÑ Õ
.žžÕ Ö
GetFileNamežžÖ á
(žžá â
fileNamežžâ ê
)žžê ë
.žžë ì
Equalsžžì ò
(žžò ó
$stržžó ‹
)žž‹ Œ
||žž 
Pathžž ”
.žž” •
GetFileNamežž•  
(žž  ¡
fileNamežž¡ ©
)žž© ª
.žžª «
Equalsžž« ±
(žž± ²
$stržž² ½
)žž½ ¾
)žž¿ À
)žžÀ Á
{
ŸŸ 
File
   
.
   
Copy
   !
(
  ! "
fileName
  " *
,
  * +

targetPath
  , 6
+
  7 8
Path
  9 =
.
  = >
GetFileName
  > I
(
  I J
fileName
  J R
)
  R S
,
  S T
true
  U Y
)
  Y Z
;
  Z [
}
¡¡ 
if
££ 
(
££ 
fileExtension
££ %
.
££% &
Equals
££& ,
(
££, -
$str
££- 2
)
££2 3
||
££4 6
fileExtension
££7 D
.
££D E
Equals
££E K
(
££K L
$str
££L R
)
££R S
)
££S T
{
¤¤ 
string
¥¥ 
newTargetPath
¥¥ ,
=
¥¥- .

targetPath
¥¥/ 9
.
¥¥9 :
Replace
¥¥: A
(
¥¥A B
$str
¥¥B N
,
¥¥N O
$str
¥¥P X
)
¥¥X Y
;
¥¥Y Z
if
¦¦ 
(
¦¦ 
!
¦¦ 
	Directory
¦¦ &
.
¦¦& '
Exists
¦¦' -
(
¦¦- .
newTargetPath
¦¦. ;
)
¦¦; <
)
¦¦< =
{
§§ 
	Directory
¨¨ %
.
¨¨% &
CreateDirectory
¨¨& 5
(
¨¨5 6
newTargetPath
¨¨6 C
)
¨¨C D
;
¨¨D E
}
©© 
File
¬¬ 
.
¬¬ 
Copy
¬¬ !
(
¬¬! "
fileName
¬¬" *
,
¬¬* +
newTargetPath
¬¬, 9
+
¬¬: ;
Path
¬¬< @
.
¬¬@ A
GetFileName
¬¬A L
(
¬¬L M
fileName
¬¬M U
)
¬¬U V
,
¬¬V W
true
¬¬X \
)
¬¬\ ]
;
¬¬] ^
}
­­ 
if
¯¯ 
(
¯¯ 
isMinify
¯¯  
&&
¯¯! #
fileName
¯¯$ ,
.
¯¯, -

IsHtmlFile
¯¯- 7
(
¯¯7 8
)
¯¯8 9
)
¯¯9 :
{
°° 
string
±± 
ntargetPath
±± *
=
±±+ ,

targetPath
±±- 7
+
±±8 9
Path
±±: >
.
±±> ?
GetFileName
±±? J
(
±±J K
fileName
±±K S
)
±±S T
;
±±T U
string
³³ 
minifiedContents
³³ /
=
³³0 1

MinifyHtml
³³2 <
(
³³< =
ntargetPath
³³= H
,
³³H I
features
³³J R
)
³³R S
;
³³S T
File
¶¶ 
.
¶¶ 
WriteAllText
¶¶ )
(
¶¶) *
ntargetPath
¶¶* 5
,
¶¶5 6
minifiedContents
¶¶7 G
,
¶¶G H
Encoding
¶¶I Q
.
¶¶Q R
UTF8
¶¶R V
)
¶¶V W
;
¶¶W X
}
·· 
}
¹¹ 
}
ºº 
foreach
½½ 
(
½½ 
string
½½ 
directories
½½ '
in
½½( *
	Directory
½½+ 4
.
½½4 5
GetDirectories
½½5 C
(
½½C D
path
½½D H
)
½½H I
)
½½I J
{
¾¾ 
string
¿¿ 

folderName
¿¿ !
=
¿¿" #
directories
¿¿$ /
.
¿¿/ 0
Replace
¿¿0 7
(
¿¿7 8
path
¿¿8 <
,
¿¿< =
$str
¿¿> @
)
¿¿@ A
;
¿¿A B
string
ÀÀ 
newCopyPath
ÀÀ "
=
ÀÀ# $

targetPath
ÀÀ% /
+
ÀÀ0 1

folderName
ÀÀ2 <
;
ÀÀ< =
if
ÂÂ 
(
ÂÂ 
Convert
ÂÂ 
.
ÂÂ 
ToInt32
ÂÂ #
(
ÂÂ# $
Array
ÂÂ$ )
.
ÂÂ) *
IndexOf
ÂÂ* 1
(
ÂÂ1 2
ignoreFolders
ÂÂ2 ?
,
ÂÂ? @

folderName
ÂÂA K
)
ÂÂK L
)
ÂÂL M
<
ÂÂN O
$num
ÂÂP Q
)
ÂÂQ R
{
ÃÃ 
newCopyPath
ÄÄ 
=
ÄÄ  !
newCopyPath
ÄÄ" -
+
ÄÄ. /
$str
ÄÄ0 4
;
ÄÄ4 5
CopyAllFiles
ÅÅ  
(
ÅÅ  !
directories
ÅÅ! ,
,
ÅÅ, -
newCopyPath
ÅÅ. 9
,
ÅÅ9 :
fromDateTime
ÅÅ; G
,
ÅÅG H
isMinify
ÅÅI Q
)
ÅÅQ R
;
ÅÅR S
}
ÆÆ 
}
ÇÇ 
}
ÈÈ 	
}
ÉÉ 
}ÊÊ þ
SD:\work\bikewaleweb\Bikewale.ReleaseManagement\copyfiles\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str $
)$ %
]% &
[		 
assembly		 	
:			 

AssemblyDescription		 
(		 
$str		 !
)		! "
]		" #
[

 
assembly

 	
:

	 
!
AssemblyConfiguration

  
(

  !
$str

! #
)

# $
]

$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str 
) 
] 
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str &
)& '
]' (
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
[## 
assembly## 	
:##	 

AssemblyVersion## 
(## 
$str## $
)##$ %
]##% &
[$$ 
assembly$$ 	
:$$	 

AssemblyFileVersion$$ 
($$ 
$str$$ (
)$$( )
]$$) *Àq
QD:\work\bikewaleweb\Bikewale.ReleaseManagement\copyfiles\StreamReaderExtension.cs
	namespace 	
HtmlMinifier
 
{ 
public 

static 
class !
StreamReaderExtension -
{		 
public 
static 
string 
MinifyHtmlCode +
(+ ,
this, 0
StreamReader1 =
reader> D
,D E
FeaturesF N
featuresO W
)W X
{ 	
return 
MinifyHtmlCode !
(! "
reader" (
.( )
	ReadToEnd) 2
(2 3
)3 4
,4 5
features6 >
)> ?
;? @
} 	
public 
static 
string 
MinifyHtmlCode +
(+ ,
string, 2
htmlCode3 ;
,; <
Features= E
featuresF N
)N O
{ 	
string 
contents 
; 
contents   
=   

MinifyHtml   !
(  ! "
htmlCode  " *
,  * +
features  , 4
)  4 5
;  5 6
contents## 
=## 
EnsureMaxLength## &
(##& '
contents##' /
,##/ 0
features##1 9
)##9 :
;##: ;
contents&& 
=&& !
ReArrangeDeclarations&& ,
(&&, -
contents&&- 5
)&&5 6
;&&6 7
return(( 
contents(( 
;(( 
})) 	
public33 
static33 
string33 !
ReArrangeDeclarations33 2
(332 3
string333 9
fileContents33: F
)33F G
{44 	

Dictionary66 
<66 
string66 
,66 
bool66 #
>66# $
declarations66% 1
=662 3
new664 7

Dictionary668 B
<66B C
string66C I
,66I J
bool66K O
>66O P
(66P Q
)66Q R
;66R S
declarations77 
.77 
Add77 
(77 
$str77 &
,77& '
true77( ,
)77, -
;77- .
declarations88 
.88 
Add88 
(88 
$str88 &
,88& '
false88( -
)88- .
;88. /
declarations99 
.99 
Add99 
(99 
$str99 )
,99) *
false99+ 0
)990 1
;991 2
foreach<< 
(<< 
var<< 
declaration<< $
in<<% '
declarations<<( 4
)<<4 5
{== 
fileContents>> 
=>>  
ReArrangeDeclaration>> 3
(>>3 4
fileContents>>4 @
,>>@ A
declaration>>B M
.>>M N
Key>>N Q
,>>Q R
declaration>>S ^
.>>^ _
Value>>_ d
)>>d e
;>>e f
}?? 
returnAA 
fileContentsAA 
;AA  
}BB 	
privateNN 
staticNN 
stringNN  
ReArrangeDeclarationNN 2
(NN2 3
stringNN3 9
fileContentsNN: F
,NNF G
stringNNH N
declarationNNO Z
,NNZ [
boolNN\ `

bringToTopNNa k
)NNk l
{OO 	
MatchCollectionQQ 
matchesQQ #
=QQ$ %
RegexQQ& +
.QQ+ ,
MatchesQQ, 3
(QQ3 4
fileContentsQQ4 @
,QQ@ A
declarationQQB M
)QQM N
;QQN O
intTT 
alreadyMatchedTT 
=TT  
$numTT! "
;TT" #
foreachUU 
(UU 
MatchUU 
matchUU  
inUU! #
matchesUU$ +
)UU+ ,
{VV 
intWW 
positionWW 
=WW 
declarationWW *
.WW* +
LengthWW+ 1
;WW1 2
intXX 
declarationPositionXX '
=XX( )
matchXX* /
.XX/ 0
IndexXX0 5
;XX5 6
if[[ 
([[ 
matches[[ 
.[[ 
Count[[ !
>[[" #
$num[[$ %
&&[[& (
alreadyMatched[[) 7
>[[8 9
$num[[: ;
)[[; <
{\\ 
declarationPosition^^ '
+=^^( *
(^^+ ,
$num^^, -
*^^. /
alreadyMatched^^0 >
)^^> ?
;^^? @
}__ 
whileaa 
(aa 
declarationPositionaa *
>=aa+ -
$numaa. /
)aa/ 0
{bb 
positiondd 
+=dd 
$numdd  !
;dd! "
stringee 
	substringee $
=ee% &
fileContentsee' 3
.ee3 4
	Substringee4 =
(ee= >
declarationPositionee> Q
,eeQ R
positioneeS [
)ee[ \
;ee\ ]
ifhh 
(hh 
	substringhh !
.hh! "
EndsWithhh" *
(hh* +
$strhh+ .
)hh. /
||hh0 2
	substringhh3 <
.hh< =
EndsWithhh= E
(hhE F
$strhhF I
)hhI J
)hhJ K
{ii 
ifjj 
(jj 

bringToTopjj &
)jj& '
{kk 
fileContentsmm (
=mm) *
fileContentsmm+ 7
.mm7 8
Replacemm8 ?
(mm? @
	substringmm@ I
,mmI J
$strmmK M
)mmM N
;mmN O
fileContentspp (
=pp) *
	substringpp+ 4
+pp5 6
Environmentpp7 B
.ppB C
NewLineppC J
+ppK L
fileContentsppM Y
;ppY Z
breakqq !
;qq! "
}rr 
elsess 
{tt 
fileContentsvv (
=vv) *
fileContentsvv+ 7
.vv7 8
Replacevv8 ?
(vv? @
	substringvv@ I
,vvI J
	substringvvK T
+vvU V
EnvironmentvvW b
.vvb c
NewLinevvc j
)vvj k
;vvk l
alreadyMatchedww *
++ww* ,
;ww, -
breakxx !
;xx! "
}yy 
}zz 
}{{ 
}|| 
return~~ 
fileContents~~ 
;~~  
} 	
public
‰‰ 
static
‰‰ 
string
‰‰ 

MinifyHtml
‰‰ '
(
‰‰' (
string
‰‰( .
htmlContents
‰‰/ ;
,
‰‰; <
Features
‰‰= E
features
‰‰F N
)
‰‰N O
{
ŠŠ 	
if
ŒŒ 
(
ŒŒ 
!
ŒŒ 
features
ŒŒ 
.
ŒŒ 
IgnoreJsComments
ŒŒ *
)
ŒŒ* +
{
 
htmlContents
ŽŽ 
=
ŽŽ &
RemoveJavaScriptComments
ŽŽ 7
(
ŽŽ7 8
htmlContents
ŽŽ8 D
)
ŽŽD E
;
ŽŽE F
}
 
htmlContents
’’ 
=
’’ 
Regex
’’  
.
’’  !
Replace
’’! (
(
’’( )
htmlContents
’’) 5
,
’’5 6
$str
’’7 c
,
’’c d
$str
’’e g
)
’’g h
;
’’h i
htmlContents
•• 
=
•• 
Regex
••  
.
••  !
Replace
••! (
(
••( )
htmlContents
••) 5
,
••5 6
$str
••7 G
,
••G H
$str
••I K
,
••K L
RegexOptions
••M Y
.
••Y Z

Singleline
••Z d
)
••d e
;
••e f
htmlContents
˜˜ 
=
˜˜ 
Regex
˜˜  
.
˜˜  !
Replace
˜˜! (
(
˜˜( )
htmlContents
˜˜) 5
,
˜˜5 6
$str
˜˜7 =
,
˜˜= >
$str
˜˜? B
)
˜˜B C
;
˜˜C D
htmlContents
›› 
=
›› 
Regex
››  
.
››  !
Replace
››! (
(
››( )
htmlContents
››) 5
,
››5 6
$str
››7 B
,
››B C
$str
››D H
)
››H I
;
››I J
htmlContents
žž 
=
žž 
Regex
žž  
.
žž  !
Replace
žž! (
(
žž( )
htmlContents
žž) 5
,
žž5 6
$str
žž7 G
,
žžG H
$str
žžI M
)
žžM N
;
žžN O
htmlContents
¡¡ 
=
¡¡ 
Regex
¡¡  
.
¡¡  !
Replace
¡¡! (
(
¡¡( )
htmlContents
¡¡) 5
,
¡¡5 6
$str
¡¡7 M
,
¡¡M N
$str
¡¡O Q
)
¡¡Q R
;
¡¡R S
htmlContents
­­ 
=
­­ 
Regex
­­  
.
­­  !
Replace
­­! (
(
­­( )
htmlContents
­­) 5
,
­­5 6
$str
­­7 ^
,
­­^ _
$str
­­` b
,
­­b c
RegexOptions
­­d p
.
­­p q

IgnoreCase
­­q {
)
­­{ |
;
­­| }
var
²² %
firstEndBracketPosition
²² '
=
²²( )
htmlContents
²²* 6
.
²²6 7
IndexOf
²²7 >
(
²²> ?
$str
²²? B
,
²²B C
StringComparison
²²D T
.
²²T U
Ordinal
²²U \
)
²²\ ]
;
²²] ^
if
³³ 
(
³³ %
firstEndBracketPosition
³³ '
>=
³³( *
$num
³³+ ,
)
³³, -
{
´´ 
htmlContents
µµ 
=
µµ 
htmlContents
µµ +
.
µµ+ ,
Remove
µµ, 2
(
µµ2 3%
firstEndBracketPosition
µµ3 J
,
µµJ K
$num
µµL M
)
µµM N
;
µµN O
htmlContents
¶¶ 
=
¶¶ 
htmlContents
¶¶ +
.
¶¶+ ,
Insert
¶¶, 2
(
¶¶2 3%
firstEndBracketPosition
¶¶3 J
,
¶¶J K
$str
¶¶L O
)
¶¶O P
;
¶¶P Q
}
·· 
return
¹¹ 
htmlContents
¹¹ 
.
¹¹  
Trim
¹¹  $
(
¹¹$ %
)
¹¹% &
;
¹¹& '
}
ºº 	
public
ÁÁ 
static
ÁÁ 
string
ÁÁ &
RemoveJavaScriptComments
ÁÁ 5
(
ÁÁ5 6
string
ÁÁ6 < 
javaScriptComments
ÁÁ= O
)
ÁÁO P
{
ÂÂ 	
Regex
ÄÄ 
extractScripts
ÄÄ  
=
ÄÄ! "
new
ÄÄ# &
Regex
ÄÄ' ,
(
ÄÄ, -
$str
ÄÄ- N
)
ÄÄN O
;
ÄÄO P
foreach
ÇÇ 
(
ÇÇ 
Match
ÇÇ 
match
ÇÇ  
in
ÇÇ! #
extractScripts
ÇÇ$ 2
.
ÇÇ2 3
Matches
ÇÇ3 :
(
ÇÇ: ; 
javaScriptComments
ÇÇ; M
)
ÇÇM N
)
ÇÇN O
{
ÈÈ 
var
ÉÉ 
scriptBlock
ÉÉ 
=
ÉÉ  !
match
ÉÉ" '
.
ÉÉ' (
Value
ÉÉ( -
;
ÉÉ- . 
javaScriptComments
ËË "
=
ËË# $ 
javaScriptComments
ËË% 7
.
ËË7 8
Replace
ËË8 ?
(
ËË? @
scriptBlock
ËË@ K
,
ËËK L
Regex
ËËM R
.
ËËR S
Replace
ËËS Z
(
ËËZ [
scriptBlock
ËË[ f
,
ËËf g
$strËËh €
,ËË€ 
$strËË‚ „
)ËË„ …
)ËË… †
;ËË† ‡
}
ÍÍ 
return
ÏÏ  
javaScriptComments
ÏÏ %
;
ÏÏ% &
}
ÐÐ 	
public
ÙÙ 
static
ÙÙ 
string
ÙÙ 
EnsureMaxLength
ÙÙ ,
(
ÙÙ, -
string
ÙÙ- 3
htmlContents
ÙÙ4 @
,
ÙÙ@ A
Features
ÙÙB J
features
ÙÙK S
)
ÙÙS T
{
ÚÚ 	
if
ÛÛ 
(
ÛÛ 
features
ÛÛ 
.
ÛÛ 
	MaxLength
ÛÛ "
>
ÛÛ# $
$num
ÛÛ% &
)
ÛÛ& '
{
ÜÜ 
int
ÝÝ 

htmlLength
ÝÝ 
=
ÝÝ  
htmlContents
ÝÝ! -
.
ÝÝ- .
Length
ÝÝ. 4
;
ÝÝ4 5
int
ÞÞ 
currentMaxLength
ÞÞ $
=
ÞÞ% &
features
ÞÞ' /
.
ÞÞ/ 0
	MaxLength
ÞÞ0 9
;
ÞÞ9 :
int
ßß 
position
ßß 
;
ßß 
while
áá 
(
áá 

htmlLength
áá !
>
áá" #
currentMaxLength
áá$ 4
)
áá4 5
{
ââ 
position
ãã 
=
ãã 
htmlContents
ãã +
.
ãã+ ,
LastIndexOf
ãã, 7
(
ãã7 8
$str
ãã8 <
,
ãã< =
currentMaxLength
ãã> N
)
ããN O
;
ããO P
htmlContents
ää  
=
ää! "
htmlContents
ää# /
.
ää/ 0
	Substring
ää0 9
(
ää9 :
$num
ää: ;
,
ää; <
position
ää= E
+
ääF G
$num
ääH I
)
ääI J
+
ääK L
$str
ääM S
+
ääT U
htmlContents
ääV b
.
ääb c
	Substring
ääc l
(
ääl m
position
ääm u
+
ääv w
$num
ääx y
)
ääy z
;
ääz {
currentMaxLength
åå $
+=
åå% '
features
åå( 0
.
åå0 1
	MaxLength
åå1 :
;
åå: ;
}
ææ 
}
çç 
return
èè 
htmlContents
èè 
;
èè  
}
éé 	
public
ëë 
static
ëë 
string
ëë 
ExtractString
ëë *
(
ëë* +
string
ëë+ 1
s
ëë2 3
,
ëë3 4
string
ëë5 ;
tag
ëë< ?
)
ëë? @
{
ìì 	
var
îî 
startTag
îî 
=
îî 
$str
îî 
+
îî  
tag
îî! $
+
îî% &
$str
îî' *
;
îî* +
int
ïï 

startIndex
ïï 
=
ïï 
s
ïï 
.
ïï 
IndexOf
ïï &
(
ïï& '
startTag
ïï' /
)
ïï/ 0
+
ïï1 2
startTag
ïï3 ;
.
ïï; <
Length
ïï< B
;
ïïB C
int
ðð 
endIndex
ðð 
=
ðð 
s
ðð 
.
ðð 
IndexOf
ðð $
(
ðð$ %
$str
ðð% )
+
ðð* +
tag
ðð, /
+
ðð0 1
$str
ðð2 5
,
ðð5 6

startIndex
ðð7 A
)
ððA B
;
ððB C
return
ññ 
s
ññ 
.
ññ 
	Substring
ññ 
(
ññ 

startIndex
ññ )
,
ññ) *
endIndex
ññ+ 3
-
ññ4 5

startIndex
ññ6 @
)
ññ@ A
;
ññA B
}
òò 	
}
óó 
}ôô ½
KD:\work\bikewaleweb\Bikewale.ReleaseManagement\copyfiles\StringExtension.cs
	namespace 	
HtmlMinifier
 
{ 
public 

static 
class 
StringExtension '
{ 
public 
static 
bool 

IsHtmlFile %
(% &
this& *
string+ 1
value2 7
)7 8
{ 	
var 
file 
= 
value 
. 
ToLower $
($ %
)% &
;& '
return 
file 
. 
EndsWith !
(! "
$str" +
)+ ,
||- /
file 
. 
EndsWith !
(! "
$str" +
)+ ,
||- /
file 
. 
EndsWith !
(! "
$str" )
)) *
||+ -
file 
. 
EndsWith !
(! "
$str" )
)) *
||+ -
file 
. 
EndsWith !
(! "
$str" (
)( )
||* ,
file 
. 
EndsWith !
(! "
$str" )
)) *
||+ -
file 
. 
EndsWith !
(! "
$str" +
)+ ,
;, -
} 	
} 
} 