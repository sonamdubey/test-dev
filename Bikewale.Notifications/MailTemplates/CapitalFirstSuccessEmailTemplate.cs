using Bikewale.Entities.Finance.CapitalFirst;
using System;

namespace Bikewale.Notifications.MailTemplates
{
    /// <summary>
    /// Created by: Sangram Nandkhile on 13-Sep-2017
    /// Summary: Capital first email template
    /// </summary>
    public class CapitalFirstSuccessEmailTemplate : ComposeEmailBase
    {
        private readonly string emailHtml;
        public CapitalFirstSuccessEmailTemplate(CapitalFirstLeadEntity objLead)
        {
            if (objLead != null) {
                emailHtml = string.Format(@"<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'><html xmlns='http://www.w3.org/1999/xhtml'><head><meta name='viewport' content='width=device-width' /><meta http-equiv='Content-Type' content='text/html; charset=UTF-8' /><title>Emailer</title></head><body style='margin:0;'><div style='max-width:600px; margin:0 auto; border: 1px solid #f5f5f5; font-family: Arial, Helvetica, sans-serif; font-size:14px; color:#4d5057; background:#ffffff; word-wrap:break-word;'><div style='color:#fff; max-width:100%; min-height:150px; background:url(""https://imgd.aeplcdn.com/0x0/bw/static/design15/mailer-images/banner-write-600x157.png"")no-repeat center -21px; padding:0 20px; '> <!-- banner starts here --><div style='font-size:10px; float:left; margin:10px 0;'><img src='https://imgd.aeplcdn.com/0x0/bw/static/design15/mailer-images/capitalfirst-logo-70x29.png' alt='Capital First' title='Capital First' width='100%' border='0' /></div><div style='font-size:10px; float:right; margin:10px 0;'><img src='https://imgd.aeplcdn.com/0x0/bw/static/design15/mailer-images/bw-white-logo-82x30.png' alt='BikeWale' title='BikeWale' width='100%' border='0' /></div> <div style='clear:both;'></div> <div style='text-align:center;background:white;border-radius:4px; box-shadow: 0 2px 4px 0 rgba(204,204,204,0.50);margin: 0 15px; padding:10px;'> <div style='width:100%; min-height:94px; font-size:28px; text-align:center; font-weight:bold;'> <div style='vertical-align: middle; min-height:20px;color: #41B4C4; font-size:22px; padding-top:20px; padding-bottom:12px;'>Congratulations!</div><div style='vertical-align: middle; min-height:20px;color: #4D5057;font-size:14px; padding-bottom:15px;'>Your loan has been approved!</div> </div> </div> </div> <!-- banner ends here --> <div> <!-- main content starts here --> <div style='color: #787878; margin: 0 auto; padding: 0 20px;line-height:1.5; max-width:600px;letter-spacing: 0;text-align:center; font-size:14px;'><div style='padding:30px 0; '><div>We are pleased to inform you that we have pre-approved your loan.</div><div>Please find your voucher below.</div></div><div style=' text-align:center;border-bottom:1px solid #E2E2E2;'> <!-- bike details starts here --><div style='font-weight:bold; font-size: 14px; text-align:center;padding-bottom:20px;'>Get in touch to process your loan</div><div style='text-align:left;'><div style=' padding-bottom:15px;'><div style='width:60%; float:left; color:#82888b;'><div style='padding:7px 5px 7px 5px;vertical-align:middle;'><div style='float:left; font-weight:bold; height:51px; width:51px;border-radius:90px; border:1px solid; background:url(""https://imgd.aeplcdn.com/0x0/bw/static/design15/mailer-images/person-20x24.png"") no-repeat center;'></div><div style='font-size:12px;height:46px;text-align:left;display:table;margin-left:60px;'><div style='display:table-cell; vertical-align:middle;'><span style='color:#4D5057;width: 100%;margin-bottom: 5px;display: inline-block;'>{0}</span><br><span>Capital First Agent</span></div></div></div></div><div style='width:40%; float:left; text-align:right;margin:20px 0;font-size: 14px;font-weight:bold;color: #3799A7;white-space: nowrap;'><a href='' style='cursor: pointer;color: #3799A7; text-decoration: none;'><img src='https://imgd.aeplcdn.com/0x0/bw/static/design15/mailer-images/teal-call-13x13.png' style='padding: 0 2px; vertical-align: middle;' alt='phone icon'/>{1}</a></div><div style='clear:both;'></div></div></div></div></div> <div style='margin:20px; text-align:center;'> <!-- bike details starts here --> <div style='font-weight:bold; font-size: 14px; text-align:center;padding-bottom:21px; color: #4D5057; '>Loan Application details</div><div style='vertical-align:top; max-width:600px; text-align:left; padding-bottom:10px; display:inline-block;'><div style='float:left; width:250px; margin-right:58px; padding-bottom:15px; line-height:1.5;'><div style='color: #787878; width:65px; float:left;'>Applicant:</div><div style='float:left; width:170px;padding-left:15px; '>{2} <br />+91 {3}<br />{4}</div><div style='clear:both;'></div></div><div style='float:left; width:250px; padding-bottom:15px;'><div style='color: #787878; width:50px; float:left;'>Model: </div><div style='float:left; width:163px;padding-left:30px;'><span style='padding-bottom:5px;display:inline-block;'>{5}</span><span style='font-size:12px;color: #A2A2A2; '>{6}</span></div><div style='clear:both;'></div></div></div> <div style='text-align:left;'> <div style=' padding-top:10px; padding-bottom:15px;'> <div style='width:60%; float:left; color: #787878;'>Total On-road price</div> <div style='width:40%; float:left; color: #002027; text-align:right; '>&#8377; {7}</div> <div style='clear:both;'></div> </div> <div style='padding-bottom:18px;'> <div style='width:60%; float:left; color: #787878;'>Down-payment</div> <div style='width:40%; float:left; color: #002027; text-align:right;'>&#8377; {8}</div> <div style='clear:both;'></div> </div> <div style='padding-bottom:18px; border-bottom:1px solid #E2E2E2;'> <div style='width:60%; float:left; color: #787878;'>Loan amount sanctioned</div> <div style='width:40%; float:left; color: #002027; text-align:right; '>&#8377; {9}</div> <div style='clear:both;'></div> </div> <div style='padding:21px 0; text-align:center;line-height:1.5;'> <div style='display:inline-block; font-weight:bold;'>EMI:<span style='font-weight:normal;'> &#8377; </span> {10} per month</div> <div style='display:inline-block; color: #787878;padding-left:5px; font-size:12px;'>For a tenure of 36 months</div> <div style='clear:both;'></div> </div> </div> </div> <!-- bike details ends here --> <div style='margin:0 8px 41px;text-align:center; '> <!-- bike details starts here --> <div style='text-align:left;'> <div style='border:1px solid #f5f5f5; max-width: 528px;margin: 0 auto;box-shadow: 0 2px 4px 0 rgba(162,162,162,0.50);'> <div style='width:46%; float:left; color:#82888b; padding-top: 9px;'><div style='font-size:12px; vertical-align:middle; padding:10px 0 15px 20px;display: inline-block;width: 100%;'><div style='text-transform:uppercase; padding-bottom:24px; text-transform:uppercase; padding-right: 13px;' >loan application<br /> voucher</div><div style='font-weight: bold;font-size: 24px;color: #3799A7;padding-bottom: 6px;padding-right:15px;'>{11}</div><span style='font-size: 9px;'>Valid till {12}</span></div> </div> <div style='width:54%; float:right; text-align:center; height: 140px; font-size: 12px;color: #3799A7;background:url(""https://imgd.aeplcdn.com/0x0/bw/static/design15/mailer-images/teal-pattern-286x140.png"") no-repeat;'><div style=' text-align:center;display: inline-block; color: #787878; margin: 19px 0 19px 30px;height: 100px; width: 100px;border:1px solid white; border-radius:90px;background:#fff;'><span style=' text-align:center;display: inline-block;padding-top: 30px;padding-bottom:6px;'>Loan Amount </span><br/><span style='font-weight: bold;font-size: 17px;color: #3799A7;'>&#8377; {9}</span></div></div> <div style='clear:both;'></div> </div></div></div> </div> <!-- steps --> <!-- main content ends here --></div></body></html>",
                objLead.AgentName,
                objLead.AgentNumber,
                objLead.FullName,
                objLead.MobileNo,
                objLead.EmailId,
                objLead.BikeName,
                objLead.VersionName,
                Bikewale.Utility.Format.FormatPrice(objLead.OnRoadPrice.ToString()),
                objLead.Downpayment,
                objLead.LoanAmountStr,
                objLead.Emi,
                objLead.VoucherNumber,
                objLead.VoucherExpiryDate.ToString("dd-MM-yyyy")
                );
            }
        }

        public override string ComposeBody()
        {
            return Convert.ToString(emailHtml);
        }
    }
}

